\documentclass{irmaart}
\input{ha.sty}
%========== gastex =====================================
\usepackage{gastex}
%========== vaucanson =====================================
\usepackage{vaucanson-g}
\ChgStateLineWidth{0.5}
\ChgEdgeLineWidth{0.5}

\newcommand{\SqrState}[3][]%
 {\StateStyle %
  \psset{framearc=0}%
  \settowidth{\VariableStateWidth}{\scalebox{\StateLabelSca}{\scalebox{\StateLabelScale}{$#1$}}}%
  \addtolength{\VariableStateWidth}{\ExtraSpace}
  \ifthenelse{\lengthtest{\VariableStateWidth < \VariableStateIntDiam}}%
        {\setlength{\VariableStateWidth}{\VariableStateIntDiam}}{}%
  \setlength{\VariableStateITPos}{\ArrowOnStateCoef\StateDiam}%
  \addtolength{\VariableStateITPos}{0.5\VariableStateWidth}%
  \addtolength{\VariableStateITPos}{-0.5\StateDiam}%
  \rput#2{\pnode(\VariableStateITPos,0){#3e}%
          \pnode(-\VariableStateITPos,0){#3w}%
          \pnode(0,\ArrowOnStateCoef\StateDiam){#3n}%
          \pnode(0,-\ArrowOnStateCoef\StateDiam){#3s}}%
  \rput#2{\rnode{#3}{\psframebox{\protect\rule[-.5\VariableStateIntDiam]{0pt}{\VariableStateIntDiam}\protect\rule{\VariableStateWidth}{0pt}}}}
  \rput#2{\VaucStateRBLabel{#1}}%
}%
%========== Shows labels refs linenumbers ==============
\usepackage[displaymath]{lineno}
\usepackage[notcite]{showkeys}
     \linenumbers
%========== Hyperref at the end ========================
\usepackage[hypertex,hyperindex,pagebackref,final]{hyperref}
%========== Time calculation ==============================
\usepackage{calc}
\newcounter{hours}\newcounter{minutes}
\newcommand\printtime{\setcounter{hours}{\time/60}%
  \setcounter{minutes}{\time-\value{hours}*60}%
  \thehours\,h\,\theminutes}
\newcommand\dateandtime{\today\quad\printtime}
%========== Algorithms ====================================
\usepackage[boxed]{algorithm}    % pour les floats algorithmes
\usepackage[noend]{algorithmic}  % pour les algorithmes
  \newlength\commentspace
  \setlength{\commentspace}{3cm}
  \newcommand\algcomment[2]{\makebox[0pt][l]{\hspace{-#1em}%
    \hspace{\commentspace}$\triangleright$ #2}}
\newcommand{\algorithmicfunc}[1]{\textsc{#1}}
\newcommand{\FUNC}[1]{\item[\algorithmicfunc{#1}]}
%========== PSTricks =====================================
\usepackage{pst-all}
 \newpsobject{showgrid}{psgrid}{%
  subgriddiv=1,griddots=10,gridlabels=6pt}
%========== Proofs =====================================
%------------- end of proof in equation -------
\newcommand{\eqed}{\tag*{\qedsymbol}}
%========== Math notations ===================================
\newcommand{\Card}{\operatorname{Card}}
\newcommand\A{\mathcal{A}}
\newcommand\B{\mathcal{B}}
\newcommand\Tau{T}
\newcommand{\cF}{\mathcal{F}}
\newcommand{\cM}{\mathcal{M}}
\newcommand{\cP}{\mathcal{P}}
\newcommand{\cQ}{\mathcal{Q}}
\newcommand{\cS}{\mathcal{S}}
\newcommand{\cT}{\mathcal{T}}
\newcommand{\cU}{\mathcal{U}}
\newcommand{\cW}{\mathcal{W}}
\newcommand\e{\varepsilon}

%========== Shortcuts =============================
\newcommand{\sa}{synchronizing au\-tom\-a\-ta}
\newcommand{\san}{synchronizing au\-tom\-a\-ton}
\newcommand{\sw}{reset word}
\newcommand{\sws}{reset words}
\newcommand{\rt}{reset threshold}
\newcommand{\scc}{strongly connected component}
\newcommand{\scn}{strongly connected}

%============Additional statements ==================
\theoremstyle{plain}
\newtheorem{question}[theorem]{Question}
%========== Hyphenation =============================

%========== For BiBTEX =============================
\def\Cerny{\v{C}ern\'y}

%====================================================
\begin{document}
%========== Headers =============================
\markboth{J.~Kari, M.~Volkov}{\v{C}ern\'{y}'s conjecture and the road coloring problem}

%=====================================================
\title{\v{C}ern\'{y}'s conjecture and the road coloring problem}
\author{Jarkko Kari$^1$,
  Mikhail Volkov$^2$}
\address{$^1$Department of Mathematics\\
FI-20014 University of Turku\\
Turku, Finland\\[2mm]
$^2$Department of Mathematics and Mechanics\\
620083 Ural State University\\
Ekaterinburg, Russia\\
email:\,\url{jkari@utu.fi,Mikhail.Volkov@usu.ru}\\[4mm]
\upshape{\dateandtime}}

%=====================================================
\maketitle\label{chapterKV}
%=====================================================

\begin{classification}
  68Q45 68R10
\end{classification}

\begin{keywords}
  Finite automata, Synchronizing automata, Reset words, \v{C}ern\'{y}'s conjecture,
  Road Coloring Problem
\end{keywords}



%==================================================
%Abstract
%\input{0-Abstract}
%Table of contents
\localtableofcontents

%=====================================================
\section{Synchronizing automata, their origins and importance}
\label{KV:sec:motivation}
%=====================================================
A complete deterministic finite automaton (DFA) $\mathcal{A}=(Q,A)$ (here and
below $Q$ stands for the state set and $A$ for the input alphabet) is called
\emph{synchronizing}\index{automaton!synchronizing} if there exists a word
$w\in A^*$ whose action resets $\mathcal{A}$, that is, $w$ leaves the automaton
in one particular state no matter at which state in $Q$ it is applied: $q\cdot
w=q'\cdot w$ for all $q,q'\in Q$. Any word $w$ with this property is said to be
a \emph{reset}\index{reset word} word for the automaton.

\begin{figure}[ht]
\unitlength=.75mm
\begin{center}
\begin{picture}(50,40)(-15,-10)
\gasset{Nh=6,Nw=6,Nmr=3,loopdiam=6} \node(A)(0,20){0}
\node(B)(20,20){1} \node(C)(20,0){2} \node(D)(0,0){3}
\drawedge(A,B){$a,b$} \drawedge(B,C){$b$} \drawedge(C,D){$b$}
\drawedge(D,A){$b$} \drawloop[loopangle=45](B){$a$}
\drawloop[loopangle=-45](C){$a$} \drawloop[loopangle=-135](D){$a$}
\end{picture}
\caption{The automaton $\mathcal{C}_4$}\label{KV:fig:C4}
\end{center}
\end{figure}
Figure~\ref{KV:fig:C4} shows a \san\ with 4~states\footnote{Here and below we
adopt the convention that edges bearing multiple labels represent bunches of
parallel edges. In particular, the edge $0\xrightarrow{a,b}1$ in
Figure\,\ref{KV:fig:C4} represents the two parallel edges $0\xrightarrow{a}1$
and $0\xrightarrow{b}1$.} denoted by $\mathcal{C}_4$. The reader can easily
verify that the word $ab^3ab^3a$ resets the automaton leaving it in the state
1. With somewhat more effort one can also check that $ab^3ab^3a$ is the
shortest reset word for $\mathcal{C}_4$. The example in Figure~\ref{KV:fig:C4}
is due to \v{C}ern\'{y}, a Slovak computer scientist, in whose pioneering
paper~\cite{Cerny:1964} the notion of a \san\ explicitly appeared for the first
time. (\v{C}ern\'{y} called such automata \emph{directable}.  The word
\emph{synchronizing} in this context was probably introduced by
Hennie~\cite{Hennie:1964}.) \marginpar{\textbf{Needs double-checking!!}}
Implicitly, however, this concept has been around since the earliest days of
automata theory. The very first \san\ that we were able to trace back in the
literature appeared in Ashby's classic book~\cite[pp.\,60--61]{Ashby:1956}, see
\cite[Section~1]{Volkov:2008} for a discussion.

In~\cite{Cerny:1964} the notion of a \san\ arose within the classic framework
of Moore's ``Gedanken-experiments''~\cite{Moore:1956}. For Moore and his
followers finite automata served as a mathematical model of devices working in
discrete mode, such as computers or relay control systems. This leads to the
following natural problem: how can we restore control over such a device if we
do not know its current state but can observe outputs produced by the device
under various actions? Moore~\cite{Moore:1956} has shown that under certain
conditions one can uniquely determine the state at which the automaton arrives
after a suitable sequence of actions (called an \emph{experiment}). Moore's
experiments were adaptive, that is, each next action was selected on the basis
of the outputs caused by the previous actions. Ginsburg~\cite{Ginsburg:1958}
considered more restricted experiments that he called \emph{uniform}. A uniform
experiment\footnote{After \cite{Gill:1961}, the name \emph{homing sequence} has
become standard for the notion.} is just a fixed sequence of actions, that is,
a word over the input alphabet; thus, in Ginsburg's experiments outputs were
only used for calculating the resulting state at the end of an experiment. From
this, just one further step was needed to come to the setting in which outputs
were not used at all. It should be noted that this setting is by no means
artificial---there exist many practical situations when it is technically
impossible to observe output signals. (Think of a satellite which loops around
the Moon and cannot be controlled from the Earth while ``behind'' the Moon.)

The original ``Gedanken-experiments'' motivation for studying \sa\
is still of importance, and reset words are frequently applied in
model-based testing of reactive systems. See \cite{Cho&Jeong&Somenzi&Pixley:1993,
Boppana&Rajan&Takayama&Fujita:1999} as typical samples of technical
contributions to the area and \cite{Sandberg:2005} for a recent survey.

Another strong motivation comes from the coding theory. We refer
to \cite[Chapters~3 and~10]{Berstel&Perrin&Reutenauer:2009} for a
detailed account of profound connections between codes and
automata; here we restrict ourselves to a special (but still very
important) case of maximal prefix codes. Recall that a
\emph{prefix code}\index{prefix code} over a finite alphabet $A$
is a set $X$ of words in $A^*$ such that no word of $X$ is a
prefix of another word of $X$. A prefix code is
\emph{maximal}\index{prefix code!maximal} if it is not contained
in another prefix code over the same alphabet. A maximal prefix
code $X$ over $A$ is \emph{synchronized}\index{prefix
code!synchronized} if there is a word $x\in X^*$ such that for any
word $w\in A^*$, one has $wx\in X^*$. Such a word $x$ is called a
\emph{synchronizing word}\index{synchronizing word of a code} for
$X$. The advantage of synchronized codes is that they are able to
recover after a loss of synchronization between the decoder and
the coder caused by channel errors: in the case of such a loss, it
suffices to transmit a synchronizing word and the following
symbols will be decoded correctly. Moreover, since the probability
that a word $v\in A^*$ contains a fixed factor $x$ tends to 1 as
the length of $v$ increases, synchronized codes eventually
resynchronize by themselves, after sufficiently many symbols being
sent. (As shown in~\cite{Capocelli&Gargano&Vaccaro:1988}, the
latter property in fact characterizes synchronized codes.) The
following simple example illustrates these ideas: let $A=\{0,1\}$
and $X=\{000,0010,0011,010,0110,0111,10,110,111\}$. Then $X$ is a
maximal prefix code and one can easily check that each of the
words 010, 011110, 011111110, \dots\ is a synchronizing word for
$X$. For instance, if the code word 000 has been sent but, due to
a channel error, the word 100 has been received, the decoder
interprets 10 as a code word, and thus, loses synchronization.
However, with a high probability this synchronization loss only
propagates for a short while; in particular, the decoder
definitely resynchronizes as soon as it encounters one of the
segments 010, 011110, 011111110, \dots\ in the received stream of
symbols. A few samples of such streams are shown in
Figure~\ref{KV:fig:decoding} in which vertical lines show the
partition of each stream into code words and the boldfaced code
words indicate the position at which the decoder resynchronizes.
\begin{figure}[h]
\begin{center}
\begin{tabular}{ll}
Sent & $0\,0\,0\ \mid 0\,0\,1\,0\,\ \mid\mathbf{0\,1\,1\,1\mid\dots}$\\
\mathstrut Received & $1\,0\mid 0\,0\,0 \mid 1\,0 \mid\mathbf{0\,1\,1\,1\mid\dots}$\\
\hline
\mathstrut Sent & $0\,0\,0\mid 0\,1\,1\,1 \mid 1\,1\,0\mid 0\,0\,1\,1 \mid 0\,0\,0 \mid 1\,0 \mid\mathbf{1\,1\,0\mid \dots}$\\
\mathstrut Received & $1\,0\mid 0\,0\,1\,1 \mid 1\,1\,1 \mid 0\,0\,0\mid 1\,1\,0 \mid 0\,0\,1\,0 \mid\mathbf{1\,1\,0\mid \dots}$\\
\hline
\mathstrut Sent & $0\,0\,0\mid 0\,0\,0 \mid 1\,1\,1\mid\mathbf{1\,0\mid \dots}$\\
\mathstrut Received & $1\,0\mid 0\,0\,0 \mid 0\,1\,1\,1 \mid\mathbf{1\,0\mid \dots}$
\end{tabular}
\caption{Restoring synchronization}\label{KV:fig:decoding}
\end{center}
\end{figure}

If $X$ is a finite prefix code over an alphabet $A$, then its
decoding can be implemented by a deterministic automaton that is
defined as follows. Let $Q$ be the set of all proper prefixes of
the words in $X$ (including the empty word $\varepsilon$). For
$q\in Q$ and $a\in A$, define
\begin{displaymath}
q\cdot a =\begin{cases} qa & \text{if $qa$ is a proper prefix of a word of $X$}\,,\\
\varepsilon & \text{if $qa \in X$}\,.\end{cases}
\end{displaymath}
The resulting automaton $\mathcal{A}_X$ is complete whenever the code $X$
is maximal and it is easy to see that $\mathcal{A}_X$ is a \san\ if and only
if $X$ is a synchronized code. Moreover, a word $x$ is synchronizing for $X$
if and only if $x$ is a \sw\ for $\mathcal{A}_X$ and sends all states in $Q$
to the state $\varepsilon$. Figure~\ref{KV:fig:huffman} illustrates this construction
for the code $X=\{000,0010,0011,010,0110,0111,10,110,111\}$ considered above.
The solid/dashed lines correspond to (the action of) 0/1.
\begin{figure}[htbp]
\FixVCScale{0.4}
\VCDraw{%
\begin{VCPicture}{(0,-1)(16,9)}
\MediumState
\ChgEdgeArrowWidth{6.5pt}
\VCPut{(0,0)}{
 \RstStateFillColor
\SqrState[0010]{(2,0)}{14}%
\SqrState[0011]{(4,0)}{15}%
\SqrState[0110]{(6,0)}{16}%
\SqrState[0111]{(8,0)}{17}%
\StateVar[001]{(3,2)}{4}%
\SqrState[000]{(1,2)}{9}%
\StateVar[011]{(7,2)}{7}%
\SqrState[010]{(5,2)}{10}%
\SqrState[110]{(11,2)}{11}%
\SqrState[111]{(13,2)}{12}%
\State[00]{(2,4)}{3}%
\State[01]{(6,4)}{6}%
\State[11]{(12,4)}{8}%
\SqrState[10]{(10,4)}{13}%
\State[0]{(4,6)}{2}%
\State[1]{(11,6)}{5}%
\State[\varepsilon]{(8,8)}{1}%
\ChgEdgeLineWidth{2}
\ChgEdgeLineColor{black}
\ChgEdgeLineStyle{solid}
\EdgeL[.5]{1}{2}{}
\EdgeL[.5]{2}{3}{}
\EdgeL[.5]{5}{13}{}
\EdgeL[.5]{3}{9}{}
\EdgeL[.5]{6}{10}{}
\EdgeL[.5]{8}{11}{}
\EdgeL[.5]{4}{14}{}
\EdgeL[.5]{7}{16}{}
\ChgEdgeLineWidth{2}
\ChgEdgeLineColor{black}
\ChgEdgeLineStyle{dashed}
\EdgeL[.5]{1}{5}{}
\EdgeL[.5]{2}{6}{}
\EdgeL[.5]{8}{12}{}
\EdgeL[.5]{4}{15}{}
\EdgeL[.5]{7}{17}{}
\EdgeL[.5]{5}{8}{}
\EdgeL[.5]{3}{4}{}
\EdgeL[.5]{6}{7}{}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\VCPut{(17,-2)}{
 \RstStateFillColor
\State[00]{(2,4)}{3}%
\State[01]{(6,4)}{6}%
\State[11]{(12,4)}{8}%
\StateVar[001]{(3,2)}{4}%
\StateVar[011]{(7,2)}{7}%
\State[0]{(4,6)}{2}%
\State[1]{(11,6)}{5}%
\State[\varepsilon]{(8,8)}{1}%
\ChgEdgeLineWidth{2}
\ChgEdgeLineColor{black}
\ChgEdgeLineStyle{solid}
\EdgeL[.5]{1}{2}{}
\EdgeL[.5]{2}{3}{}
\VCurveR[0.5]{angleA=90,angleB=2,ncurv=1.2}{5}{1}{}
\VArcR[.5]{arcangle=60,ncurv=0.7}{3}{1}{}
\ArcR[.5]{6}{1}{}
\ChgEdgeLineWidth{2}
\ChgEdgeLineColor{black}
\ChgEdgeLineStyle{dashed}
\EdgeL[.5]{1}{5}{}
\EdgeL[.5]{2}{6}{}
\ChgEdgeLineWidth{2}
\ChgEdgeLineColor{black}
\ChgEdgeLineStyle{solid}
\VCurveR[0.5]{angleA=140,angleB=140,ncurv=1.6}{4}{1}{}
\VCurveR[0.5]{angleA=20,angleB=50,ncurv=.9}{8}{1}{}
\VCurveR[0.5]{angleA=25,angleB=-74,ncurv=.6}{7}{1}{}
\ChgEdgeLineWidth{2}
\ChgEdgeLineColor{black}
\ChgEdgeLineStyle{dashed}
\EdgeL[.5]{3}{4}{}
\EdgeL[.5]{6}{7}{}
\EdgeL[.5]{5}{8}{}
\VCurveR[0.5]{angleA=170,angleB=120,ncurv=1.9}{4}{1}{}
\VCurveR[0.5]{angleA=10,angleB=76,ncurv=1.2}{8}{1}{}
\VCurveR[0.5]{angleA=15,angleB=-56,ncurv=.8}{7}{1}{}
}
\end{VCPicture}%
}
\caption{A synchronized code (on the left) and its automaton (on the right)}\label{KV:fig:huffman}
\end{figure}

Thus, \textbf{(to be continued and supplied by some historical
references).}

An additional source of problems related to \sa\ has come from
\emph{robotics} or, more precisely, from part handling problems
in industrial automation such as part feeding, fixturing, loading,
assembly and packing. Within this framework, the concept of a \san\
was again rediscovered in the mid-1980s by Natarajan \cite{Natarajan:1986,
Natarajan:1989} who showed how \sa\ can be used to design sensor-free
orienters for polygonal parts, see \cite[Section~1]{Volkov:2008} for
a transparent example illustrating Natarajan's approach in a nutshell.
Since the 1990s \sa\ usage in the area of robotic manipulation has grown
into a prolific research direction but it is fair to say that publications
in this area deal mostly with implementation technicalities. However,
amongst them there are papers of significant theoretical importance
such as \cite{Eppstein:1990,Goldberg:1993,Chen&Ierardi:1995}.

\marginpar{\textbf{To~be\\ checked\\ with\\ Jarrko!!}} Recently, it has been
realized that a notion that arose in studying of \emph{substitution systems} is
also closely related to \sa. A \emph{substitution}\index{substitution} on a
finite alphabet $X$ is a map $\sigma:X\to X^+$; the substitution is said to be
of \emph{constant length}\index{substitution!of finite length} if all words
$\sigma(x)$, $x\in X$, have the same length. One says that $\sigma$ satisfies
the \emph{coincidence condition}\index{coincidence condition} if there exist
positive integers $m$ and $k$ such that all words $\sigma^k(x)$ have the same
letter in the $m$-th position. For an example, consider the substitution $\tau$
on $X=\{0,1,2\}$ defined by $0\mapsto 11,\ 1\mapsto 12,\ 2\mapsto 20$.
Calculating the iterations of $\tau$ up to $\tau^4$ (see
Figure~\ref{KV:fig:substituion}), we observe that
\begin{figure}[h]
\begin{center}
$\begin{matrix}
0&\mapsto&11&\mapsto&1212&\mapsto&12201220&\mapsto&122020\mathbf{1}112202011\\
1&\mapsto&12&\mapsto&1220&\mapsto&12202011&\mapsto&122020\mathbf{1}120111212\\
2&\mapsto&20&\mapsto&2011&\mapsto&20111212&\mapsto&201112\mathbf{1}212201220
\end{matrix}$ \caption{A substitution satisfying the coincidence
condition} \label{KV:fig:substituion}
\end{center}
\end{figure}
$\tau$ satisfies the coincidence condition (with $k=4$, $m=7$).

The importance of the coincidence condition comes from the crucial fact
(established by Dekking~\cite{Dekking:1978}) that it is this condition that
completely characterizes the constant length substitutions which give rise to
dynamical systems measure-theoretically isomorphic to a translation on a
compact Abelian group, see \cite[Chapter~7]{PytheasFogg:2002} for a survey. For
us, however, the coincidence condition is primarily interesting as yet another
incarnation of synchronizability. Indeed, there is a straightforward bijection
between DFAs and constant length substitutions. Each DFA $\mathcal{A}=(Q,A)$
with $A=\{a_1,\dots,a_\ell\}$ defines a length $\ell$ substitution on $Q$ that
maps every $q\in Q$ to the word $(q\cdot a_1)\dots (q\cdot a_\ell)\in Q^+$.
(For instance, the automaton $\mathcal{C}_4$ in Figure~\ref{KV:fig:C4} induces
the substitution $0\mapsto 11,\ 1\mapsto 12,\ 2\mapsto 23,\ 3\mapsto 30$.)
Conversely, each substitution $\sigma:X\to X^+$ such that all words
$\sigma(x)$, $x\in X$, have the same length $\ell$ gives rise to a DFA for
which $X$ serves as the state set and which has $\ell$ input letters
$a_1,\dots,a_\ell$, say, acting on $X$ as follows: $x\cdot a_i$ is the symbol
in the $i$-th position of the word $\sigma(x)$. (For instance, the substitution
$\tau$ considered in the previous paragraph defines the automaton shown in
Figure~\ref{KV:fig:C3}.)
\begin{figure}[ht]
\unitlength=.75mm
\begin{center}
\begin{picture}(50,30)(-15,-10)
\gasset{Nh=6,Nw=6,Nmr=3,loopdiam=6} \node(A)(10,20){0} \node(C)(20,0){1}
\node(D)(0,0){2} \drawedge(A,C){$a_1,a_2$} \drawedge(C,D){$a_2$}
\drawedge(D,A){$a_2$} \drawloop[loopangle=-45](C){$a_1$}
\drawloop[loopangle=-135](D){$a_1$}
\end{picture}
\caption{The automaton induced by the substitution $0\mapsto 11,\ 1\mapsto 12,\
2\mapsto 20$}\label{KV:fig:C3}
\end{center}
\end{figure}
It is clear that under the described bijection substitutions satisfying the
coincidence condition correspond precisely to \sa, and moreover, given a
substitution, the number of iterations at which the coincidence first occurs is
equal to the minimum length of \sw\ for the corresponding automaton.

We mention in passing a purely algebraic framework\marginpar{\textbf{If space\\
permits!!}} within which \sa\ also appear in a natural way. One may treat DFAs
as unary algebras since each letter of the input alphabet defines a unary
operation on the state set. A \emph{term}\index{unary term} in the language of
such unary algebras is an expression $t$ of the form $x\cdot w$, where $x$ is a
variable and $w$ is a word over an alphabet $A$. An
\emph{identity}\index{identity of unary algebras} is a formal equality between
two terms. A DFA $\mathcal{A}=(Q,A)$ \emph{satisfies} an identity $t_1=t_2$,
where the words involved in the terms $t_1$ and $t_2$ are over $A$, if $t_1$
and $t_2$ take the same value under each interpretation of their variables in
the set $Q$. Identities of unary algebras can be of the from either $x\cdot
u=x\cdot v$ (\emph{homotypical} identities\index{identity of unary
algebras!homotypical}) or $x\cdot u=y\cdot v$ with $x\ne y$
(\emph{heterotypical} identities\index{identity of unary
algebras!heterotypical}). It is easy to realize that a DFA is synchronizing if
and only if it satisfies a heterotypical identity, and thus, studying \sa\ may
be considered as a part of the equational logic of unary algebras. In
particular, \sa\ over a fixed alphabet form a \emph{pseudovariety} of unary
algebras. See \cite{Bogdanovic&Imreh&Ciric&Petkovic:1999} for a survey of
numerous publications in this direction; it is fair to say, however, that so
far this algebraic approach has not proved to be really useful for
understanding the combinatorial nature of \sa.

%=====================================================
\section{Algorithmic and complexity issues}
\label{KV:sec:algorithms&complexity}
%=====================================================
It should be clear that not every DFA is synchronizing. Therefore, the very
first question that we should address is the following one: \emph{given an
automaton $\mathcal{A}$, how to determine whether or not $\mathcal{A}$ is
synchronizing?}

\begin{figure}[htb]
\begin{center}
\unitlength=.75mm
\begin{picture}(85,80)(-10,25)
\gasset{Nh=6,Nw=6,Nmr=3,loopdiam=6} \node(A)(-20,57){0}
\node(B)(0,57){1} \node(C)(0,38){2} \node(D)(-20,38){3}
\drawedge(A,B){$a,b$} \drawedge(B,C){$b$} \drawedge(C,D){$b$}
\drawedge(D,A){$b$} \drawloop[loopangle=45](B){$a$}
\drawloop[loopangle=-45](C){$a$} \drawloop[loopangle=-135](D){$a$}
\node(AD)(20,38){03} \node(AB)(20,57){01} \node(BC)(40,57){12}
\node(CD)(40,38){23} \node(AC)(60,57){02} \node(BD)(80,57){13}
\drawloop[loopangle=0](CD){$a$} \drawloop[loopangle=0](BD){$a$}
\drawloop[loopangle=45](BC){$a$}
\drawedge[linewidth=.5,AHLength=2,ELside=r](CD,AD){$b$}
\drawedge[linewidth=.5,AHLength=2](AD,AB){$b$}
\drawedge(AB,BC){$b$}
\drawedge[linewidth=.5,AHLength=2](BC,CD){$b$}
\drawedge[linewidth=.5,AHLength=2,curvedepth=5](AB,B){$a$}
\gasset{Nadjust=w,Nadjustdist=1.5,Nh=6,Nmr=2}
\node(ABC)(40,76){012} \node(ABD)(70,76){013}
\node(BCD)(40,95){123} \node(ACD)(70,95){023}
\node(ABCD)(10,95){0123} \drawloop(ABCD){$b$} \drawloop(BCD){$a$}
\drawedge[linewidth=.5,AHLength=2](ABCD,BCD){$a$}
\drawedge[linewidth=.5,AHLength=2,ELside=r](BCD,ACD){$b$}
\drawedge[curvedepth=-5,ELside=r](ACD,BCD){$a$}
\drawedge[linewidth=.5,AHLength=2](ACD,ABD){$b$}
\drawedge(ABC,BCD){$b$}
\drawedge[linewidth=.5,AHLength=2,ELside=r](ABD,ABC){$b$}
\drawedge[linewidth=.5,AHLength=2,curvedepth=-5,ELside=r](ABC,BC){$a$}
\drawedge[curvedepth=5](ABD,BD){$a$}
\drawedge[curvedepth=5](AC,BC){$a$}
\drawedge[curvedepth=5](BD,AC){$b$} \drawedge(AC,BD){$b$}
\drawedge[curvedepth=-20,ELside=r](AD,BD){$a$}
\end{picture}
\caption{The power automaton
$\mathcal{P}(\mathcal{C}_4$)}\label{KV:fig:power automaton}
\end{center}
\end{figure}

This question is in fact quite easy, and the most straightforward solution to
it can be achieved via the classic subset construction by Rabin and
Scott~\cite{Rabin&Scott:1959}. Given a DFA $\mathcal{A}=(Q,A)$, we define its
\emph{subset automaton}\index{subset automaton} $\mathcal{P}(\mathcal{A})$ on
the set of the non-empty subsets of $Q$ by setting $P\cdot a=\{p\cdot a\mid
p\in P\}$ for each non-empty subset $P$ of $Q$ and each $a\in\A$. (Since we
start with a deterministic automaton, we do not need adding the empty set to
the state set of $\mathcal{P}(\mathcal{A})$.) Figure~\ref{KV:fig:power
automaton} presents the subset automaton for the DFA $\mathcal{C}_4$ shown in
Figure~\ref{KV:fig:C4}.

Now it is obvious that a word $w\in A^*$ is a reset word for the DFA
$\mathcal{A}$ if and only if $w$ labels a path in $\mathcal{P}(\mathcal{A})$
starting at $Q$ and ending at a singleton. (For instance, the bold path in
Figure~\ref{KV:fig:power automaton} represents the shortest reset word
$ab^3ab^3a$ of the automaton $\mathcal{C}_4$.) Thus, the question of whether or
not a given DFA $\mathcal{A}$ is synchronizing reduces to the following
reachability question in the underlying graph\footnote{By a
\emph{graph}\index{graph} we mean a quadruple of sets and maps: the set of
\emph{vertices} $V$, the set of \emph{edges} $E$, a map $t: E\to V$ that maps
every edge to its \emph{tail} vertex, and a map $h:E\to V$ that maps every edge
to its \emph{head} vertex. Notice that in a graph, there may be several edges
with the same tail and head. (Thus, our graphs are in fact directed multigraphs
but since no other graph species show up in this chapter, we use a short name.)
We assume the reader's acquaintance with basic notions of graph theory such as
path, cycle, etc. The \emph{underlying graph} of an automaton $\mathcal{A}$ is
the graph obtained from $\mathcal{A}$ by forgetting edge
labels.\index{underlying graph (of an automaton)}} of the subset automaton
$\mathcal{P}(\mathcal{A})$: is there a path from $Q$ to a singleton? The latter
question can be easily answered by breadth-first search, see, e.g.,
\cite[Section~22.2]{Cormen&Leiserson&Rivest&Stein:2001}.

The described procedure is conceptually very simple but rather inefficient
because the power automaton $\mathcal{P}(\mathcal{A})$ is exponentially larger
than $\mathcal{A}$. However, the following criterion of synchronizability gives
rise to a polynomial algorithm.
\begin{proposition}[{\mdseries\cite[Theorem~2]{Cerny:1964}}]
\label{KV:prop:quadratic} A DFA $\mathcal{A}=(Q,A)$ is synchronizing if and
only if for every $q,q'\in Q$ there exists a word $w\in A^*$ such that $q\cdot
w=q'\cdot w$.
\end{proposition}

\begin{proof}
Of course, only sufficiency needs a proof. For this, take two
states $q,q'\in Q$ and consider a word $w_1$ such that $q\cdot
w_1=q'\cdot w_1$. Then $|Q\cdot w_1|<|Q|$. If $|Q\cdot w_1|=1$,
then $w_1$ is a \sw\ and $\mathcal{A}$ is synchronizing. If
$|Q\cdot w_1|>1$, take two states $p,p'\in Q\cdot w_1$ and
consider a word $w_2$ such that $p\cdot w_2=p'\cdot w_2$. Then
$|Q\cdot w_1w_2|<|Q\cdot w_1|$. If $|Q\cdot w_1w_2|=1$, then
$w_1w_2$ is a \sw; otherwise we repeat the process. Clearly, a
\sw\ for $\mathcal{A}$ will be constructed in at most $|Q|-1$
steps.
\end{proof}

One can treat Proposition~\ref{KV:prop:quadratic} as a reduction of the
synchronizability problem to a reachability problem in the subautomaton
$\mathcal{P}^{[2]}(\mathcal{A})$ of $\mathcal{P}(\mathcal{A})$ whose states are
\emph{couples}\index{couple} (2-element subsets) and singletons of $Q$. Since
the subautomaton has $\dfrac{|Q|(|Q|+1)}2$ states, breadth-first search solves
this problem in $O(|Q|^2\cdot|A|)$ time. This complexity bound assumes that no
reset word is explicitly calculated. If one requires that, whenever
$\mathcal{A}$ turns out to be synchronizing, a reset word is produced, then the
best of the known algorithms (which is basically due to Eppstein
\cite[Theorem~6]{Eppstein:1990}, see also \cite[Theorem~1.15]{Sandberg:2005})
has an implementation that consumes $O(|Q|^3 + |Q|^2\cdot|A|)$ time and
$O(|Q|^2 + |Q|\cdot|A|)$ working space, not counting the space for the output
which is $O(|Q|^3)$.

For a \san, the subset automaton can be used to construct shortest reset words
as they correspond to shortest paths from the whole state set $Q$ to a
singleton. Of course, this requires exponential (of $|Q|$) time in the worst
case. Nevertheless, there were attempts to implement this approach, see, e.g.,
\cite{Rho&Somenzi&Pixley:1993,Trahtman:2006}. One may hope that, as above, a
suitable calculation in the ``polynomial'' subautomaton
$\mathcal{P}^{[2]}(\mathcal{A})$ may yield a polynomial algorithm. However, it
is not the case, and moreover, as we will see, it is very unlikely that any
reasonable algorithm may exist for finding shortest reset words in general \sa.
In the following discussion we assume the reader's acquaintance with some
basics of computational complexity (such as the definitions of the complexity
classes \textsf{NP} and \textsf{coNP}) that can be found, e.g.,
in~\cite{Garey&Johnson:1979,Papadimitriou:1994}.

Consider the following decision problem:\index{Short@\textsc{Short-Reset-Word}}

\smallskip

\hangindent=\parindent \noindent\textsc{Short-Reset-Word:}
\emph{Given a \san\ $\mathcal{A}$ and a positive integer $\ell$,
is it true that $\mathcal{A}$ has a reset word of length $\ell$?}

\smallskip

Clearly, \textsc{Short-Reset-Word} belongs to the complexity class
\textsf{NP}: one can non-deterministically guess a word $w\in A^*$
of length $\ell$ and then check if $w$ is a reset word for
$\mathcal{A}$ in time $\ell|Q|$. Several
authors~\cite{Rystsov:1980,Eppstein:1990,Goralcik&Koubek:1995,Salomaa:2003,Samotij:2007}
have proved that \textsc{Short-Reset-Word} is \textsf{NP}-hard by
a polynomial reduction from \textsc{SAT} (the satisfiability
problem for a system of \emph{clauses}, that is, disjunctions of
literals). We reproduce here Eppstein's reduction
from~\cite{Eppstein:1990}.

Given an arbitrary instance $\psi$ of \textsc{SAT} with $n$
variables $x_1,\dots,x_n$ and $m$ clauses $c_1,\dots,c_m$, we
construct a DFA $\mathcal{A}(\psi)$ with 2 input letters $a$ and
$b$ as follows. The state set $Q$ of $\mathcal{A}(\psi)$ consists
of $(n+1)m$ states $q_{i,j}$, $1 \le i \le m$, $1 \le j \le n+1$,
and a special state $z$. The transitions are defined by
\begin{align*}
& q_{i,j}\cdot a =
\begin{cases}
    z \text{ if the literal $x_j$ occurs in $c_i$},\\
    q_{i,j+1} \text{ otherwise}
\end{cases} && \text{ for $1 \le i \le m$, $1 \le j \le n$;} \\
&q_{i,j}\cdot b =
\begin{cases}
    z \text{ if the literal $\neg x_j$ occurs in $c_i$},\\
    q_{i,j+1} \text{ otherwise}
\end{cases} && \text{ for $1 \le i \le m$, $1 \le j \le n$;} \\
&q_{i,n+1}\cdot a=q_{i,n+1}\cdot b =z\cdot a=z\cdot b=z && \text{ for $1\le
i\le m$.}
\end{align*}
Figure~\ref{KV:fig:A2_example} shows two automata of the form
$\mathcal{A}(\psi)$ build for the \textsc{SAT} instances
\begin{align*}
\psi_1&=\{x_1 \vee x_2 \vee x_3,\, \neg x_1 \vee x_2,\, \neg x_2
\vee x_3,\,\neg x_2 \vee \neg x_3\},\\
\psi_2&=\{x_1 \vee x_2,\,\neg x_1 \vee x_2,\, \neg x_2 \vee
x_3,\,\neg x_2 \vee \neg x_3\}.
\end{align*}
If at some state $q\in Q$ in Figure~\ref{KV:fig:A2_example} there
is no outgoing edge labelled $c\in\{a,b\}$, the edge
$q\stackrel{c}{\to}z$ is assumed (those edges are omitted to
improve readability). The two instances differ only in the first
clause: in $\psi_1$ it contains the literal $x_3$ while in
$\psi_2$ it does not. Correspondingly, the automata
$\mathcal{A}(\psi_1)$ and $\mathcal{A}(\psi_2)$ differ only by the
outgoing edge labelled $a$ at the state $q_{1,3}$: in
$\mathcal{A}(\psi_1)$ it leads to $z$ (and therefore, it is not
shown) while in $\mathcal{A}(\psi_2)$ it leads to the state
$q_{1,4}$ and is shown by the dashed line.

Observe that $\psi_1$ is satisfiable for the truth assignment
$x_1=x_2=0$, $x_3=1$ while $\psi_2$ is not satisfiable. It is not
hard to check that the word $bba$ resets $\mathcal{A}(\psi_1)$
while $\mathcal{A}(\psi_2)$ is reset by no word of length~3 but by
every word of length~4.

\begin{figure}[t]
\unitlength=.75mm
\begin{center}
\begin{picture}(120,85)(-100,-10)
\node(n478)(-50,0){$q_{1,2}$} \node(n479)(10,0){$q_{1,4}$}
\node(n480)(-80,0){$q_{1,1}$} \node(n481)(-20,0){$q_{1,3}$}
\node(n75)(-50,20){$q_{2,2}$} \node(n32)(-20,20){$q_{2,3}$}
\node(n41)(10,20){$q_{2,4}$} \node(n202)(-80,20){$q_{2,1}$}
\node(n42)(10,40){$q_{3,4}$} \node(n172)(-80,40){$q_{3,1}$}
\node(n14)(-50,40){$q_{3,2}$} \node(n472)(-20,40){$q_{3,3}$}
\node(n474)(-50,60){$q_{4,2}$} \node(n475)(10,60){$q_{4,4}$}
\node(n476)(-80,60){$q_{4,1}$} \node(n477)(-20,60){$q_{4,3}$}

\drawedge(n480,n478){$b$} \drawedge(n478,n481){$b$}
\drawedge[ELdist=1.1](n32,n41){$a,b$} \drawedge(n472,n42){$b$}
\drawedge[ELdist=1.1,ELside=r](n476,n474){$a,b$}
\drawedge[ELside=r](n474,n477){$a$}
\drawedge[ELside=r](n477,n475){$a$} \drawedge(n202,n75){$a$}
\drawedge(n75,n32){$b$} \drawedge[ELdist=1.1](n172,n14){$a,b$}
\drawedge(n14,n472){$a$}

\node[Nw=8.32,Nh=7.0,Nmr=0.0](n1310)(-65,70){$x_1$}
\node[Nw=8.32,Nh=7.0,Nmr=0.0](n1316)(-35,70){$x_2$}
\node[Nw=8.32,Nh=7.0,Nmr=0.0](n1318)(-5,70){$x_3$}
\node[Nw=8.32,Nh=7.0,Nmr=0.0](n1367)(-95,0){$c_1$}
\node[Nw=8.32,Nh=7.0,Nmr=0.0](n1368)(-95,20){$c_2$}
\node[Nw=8.32,Nh=7.0,Nmr=0.0](n1369)(-95,40){$c_3$}
\node[Nw=8.32,Nh=7.0,Nmr=0.0](n1370)(-95,60){$c_4$}

\node(n1646)(30,30){$z$}

\drawedge[dash={3.0 3.0}{0.0},curvedepth=6](n481,n479){$a$ in
$\mathcal{A}(\psi_2)$}
\drawedge[curvedepth=-6,ELside=r,ELdist=2.0](n481,n479){$b$}
\end{picture}
\end{center}
\caption{The automata $\mathcal{A}(\psi_1)$ and
$\mathcal{A}(\psi_2)$} \label{KV:fig:A2_example}
\end{figure}

In general, it is easy to see that $\mathcal{A}(\psi)$ is reset by
every word of length $n+1$ and is reset by a word of length $n$ if
and only if $\psi$ is satisfiable. Therefore assigning the
instance $(\mathcal{A}(\psi),n)$ of \textsc{Short-Reset-Word} to
an arbitrary $n$-variable instance $\psi$ of \textsc{SAT}, one
obtains a polynomial reduction of the latter problem to the
former. Since \textsc{SAT} is \textsf{NP}-complete and
\textsc{Short-Reset-Word} lies in \textsf{NP}, we obtain the
following.

\begin{proposition}
\label{KV:prop:complexity1} The problem \textsc{Short-Reset-Word} is
\textsf{NP}-complete.\qed
\end{proposition}

In fact, as observed by Samotij~\cite{Samotij:2007}, the above construction
yields slightly more\footnote{Actually, the reduction in~\cite{Samotij:2007} is
not correct but the result claimed can be easily recovered as shown below.}.
Consider the following decision
problem:\index{Shorthest@\textsc{Shortest-Reset-Word}}

\smallskip

\hangindent=\parindent \noindent \textsc{Shortest-Reset-Word:}
\emph{Given a \san\ $\mathcal{A}$ and a positive integer $\ell$,
is it true that the minimum length of a reset word for
$\mathcal{A}$ is equal to $\ell$?}

\smallskip

\noindent Assigning the instance $(\mathcal{A}(\psi),n+1)$ of
\textsc{Shortest-Reset-Word} to an arbitrary system $\psi$ of clauses on $n$
variables, one sees that the answer to the instance is ``Yes'' if and only if
$\psi$ is not satisfiable. Thus, we have a polynomial reduction from the
negation of \textsc{SAT} to \textsc{Shortest-Reset-Word} whence the latter
problem is \textsf{coNP}-hard. As a corollary, \textsc{Shortest-Reset-Word}
cannot belong to \textsf{NP} unless \textsf{NP}\,=\,\textsf{coNP} which is
commonly considered to be very unlikely. In other words, even non-deterministic
algorithms cannot decide the \emph{\rt}\index{reset threshold} of a given \san,
(that is, the minimum length of its \sws) in polynomial time.

The exact complexity of the problem \textsc{Shortest-Reset-Word}
has been recently determined by
Gawrychowski~\cite{Gawrychowski:2008} and, independently, by
Olschewski and Ummels~\cite{Olschewski&Ummels:2010}. It turns out
that the appropriate complexity class is \textsf{DP}
(\textsf{Difference Polynomial-Time}) introduced by Papadimitriou
and Yannakakis~\cite{Papadimitriou&Yannakakis:1984}; this class
consists of languages of the form $L_1\cap L_2$ where $L_1$ is a
language from \textsf{NP} and a $L_2$ is a language in
\textsf{coNP}. A ``standard'' \textsf{DP}-complete problem is
\textsc{SAT-UNSAT} whose instance is a pair of clause systems
$\psi,\chi$, say, and whose question is whether $\psi$ is
satisfiable and $\chi$ is unsatisfiable.

\begin{proposition}
\label{KV:prop:complexity2} The problem \textsc{Shortest-Reset-Word} is
\textsf{DP}-complete.\qed
\end{proposition}

Proposition~\ref{KV:prop:complexity2} follows from mutual
reductions between \textsc{Shortest-Reset-Word} and
\textsc{SAT-UNSAT} obtained
in~\cite{Gawrychowski:2008,Olschewski&Ummels:2010}.

The complexity class $\mathsf{P}^\mathsf{NP[log]}$ consists of all
problems solvable by a deterministic polynomial-time Turing
machine that has an access to an oracle for an
\textsf{NP}-complete problem, with the number of queries being
logarithmic in the size of the input. The class \textsf{DP} is
contained in $\mathsf{P}^\mathsf{NP[log]}$ (in fact, for every
problem in \textsf{DP} two oracle queries suffice) and the
inclusion is believed to be strict. Olschewski and
Ummels~\cite{Olschewski&Ummels:2010} have shown that the problem
of computing the \rt\ (as opposed to deciding whether it is equal
to a given integer) is complete for the functional analogue
$\mathsf{FP}^\mathsf{NP[log]}$ of the class
$\mathsf{P}^\mathsf{NP[log]}$ (see \cite{Selman:1994} for a
discussion of functional complexity classes). Hence, this problem
appears to be even harder than deciding the \rt. Recently
Berlinkov~\cite{Berlinkov:2010} has shown (assuming
\textsf{P}\,$\ne$\,\textsf{NP}) that no polynomial algorithm can
approximate within a constant factor the \rt\ of a given \san\
with two input letters.

The problem of finding a \sw\ of minimum length (as opposed to computing only
the length without writing down the word itself) may be even more difficult.
From the cited result of~\cite{Olschewski&Ummels:2010} it follows that the
problem is $\mathsf{FP}^\mathsf{NP[log]}$-hard but its exact complexity is not
known yet.

The hardness results
in~\cite{Berlinkov:2010,Olschewski&Ummels:2010} are obtained via
suitable encodings of \textsc{SAT} in the flavor of the above
proof of Proposition~\ref{KV:prop:complexity1}. Gerbush and
Heeringa~\cite{Gerbush&Heeringa:2011} have observed that some
other well-known hard problems such as \textsc{SCS}
(\textsc{Shortest Common Supersequence}) or \textsc{Set Cover}
admit a transparent reduction to the problem of finding a \sw\ of
minimum length for a given \san. In particular, since \textsc{SCS}
is known to have no approximation within a constant factor unless
\textsf{P}\,=\,\textsf{NP} \cite{Jiang&Li:1995}, they have deduced
a similar conclusion for approximating the \rt\ but---in contrast
to the cited result of~\cite{Berlinkov:2010}---without any bound
on the size of the input alphabet. Moreover, using a recent result
on \textsc{Set Cover}~\cite{Alon&Moshkovitz&Safra:2006}, they have
concluded that the \rt\ of \sa\ with $n$ states and unbounded
alphabet cannot be approximated within the factor $c\log n$ for
some constant $c>0$ unless \textsf{P}\,=\,\textsf{NP}. It is a
challenging problem to study approximation of the \rt\ within a
logarithmic factor for \sa\ with a fixed alphabet size.

We mention that Pixley, Jeong and Hachtel~\cite{Pixley&Jeong&Hachtel:1992}
suggested an heuristic polynomial algorithm for finding short \sws\ in \sa\
that was reported to perform rather satisfactory on a number of benchmarks
from~\cite{Yang:1991}; further polynomial algorithms yielding short (though not
necessarily shortest) \sws\ have been implemented by
Trahtman~\cite{Trahtman:2006} and Roman~\cite{Roman:2009,Roman:2009a}. Some
algorithms for finding \sws\ will be also discussed in the next section.

%=====================================================
\section{Around the \v{C}ern\'{y} conjecture}
\label{KV:sec:Cerny conjecture}
%=====================================================
\paragraph*{The \v{C}ern\'{y} conjecture.} A very natural question to ask
is the following: \emph{given a positive integer $n$, how long can be \sws\ for
\sa\ with $n$ states?} \v{C}ern\'{y}~\cite{Cerny:1964} found a lower bound by
constructing, for each $n>1$, a \san\
$\mathcal{C}_n$\index{automaton!\v{C}ern\'{y}} with $n$ states and 2 input
letters whose shortest \sw\ has length $(n-1)^2$. We assume that the state set
of $\mathcal{C}_n$ is $Q=\{0,1,2,\dots,n-1\}$ and the input letters are $a$ and
$b$, subject to the following action on $Q$:
\begin{displaymath}
i\cdot a=\begin{cases}
i &\text{if } i>0,\\
1 &\text{if } i=0;
\end{cases}\quad
i\cdot b=i+1\!\!\pmod{n}.
\end{displaymath}
Our first example of \san\ (see Figure~\ref{KV:fig:C4}) is, in fact,
$\mathcal{C}_4$. A generic automaton $\mathcal{C}_n$ is shown in
Figure~\ref{KV:fig:cerny-n} on the left.

\begin{figure}[ht]
\begin{center}
\unitlength .45mm
\begin{picture}(72,76)(25,-86)
\gasset{Nw=16,Nh=16,Nmr=8,loopdiam=12} \node(n0)(36.0,-16.0){1}
\node(n1)(4.0,-40.0){$0$} \node(n2)(68.0,-40.0){2}
\node(n3)(16.0,-72.0){$n{-}1$} \node(n4)(56.0,-72.0){3}
\drawedge[ELdist=2.0](n1,n0){$a,b$}
\drawedge[ELdist=1.5](n2,n4){$b$}
\drawedge[ELdist=1.7](n0,n2){$b$}
\drawedge[ELdist=1.7](n3,n1){$b$}
\drawloop[ELdist=1.5,loopangle=30](n2){$a$}
\drawloop[ELdist=2.4,loopangle=-30](n4){$a$}
\drawloop[ELdist=1.5,loopangle=-90](n0){$a$}
\drawloop[ELdist=1.5,loopangle=210](n3){$a$} \put(31,-73){$\dots$}
\end{picture}
\begin{picture}(72,76)(-25,-86)
\gasset{Nw=16,Nh=16,Nmr=8} \node(n0)(36.0,-16.0){1}
\node(n1)(4.0,-40.0){$0$} \node(n2)(68.0,-40.0){2}
\node(n3)(16.0,-72.0){$n{-}1$} \node(n4)(56.0,-72.0){3}
\drawedge[ELdist=2.0](n1,n0){$b$}
\drawedge[ELdist=1.5](n2,n4){$b,c$}
\drawedge[ELdist=1.7](n0,n2){$b,c$}
\drawedge[ELdist=1.7](n3,n1){$b,c$}
\drawedge[ELdist=2.0](n1,n2){$c$} \put(31,-73){$\dots$}
\end{picture}
\end{center}
\caption{The DFA $\mathcal{C}_n$ and the DFA $\mathcal{W}_n$
induced by the actions of $b$ and $c=ab$}\label{KV:fig:cerny-n}
\end{figure}

The series $\{\mathcal{C}_n\}_{n=2,3,\dots}$ was rediscovered many times (see,
e.g.,
\cite{Laemmel&Rudner:1969,Fischler&Tannenbaum:1970,Eppstein:1990,Frettloh&Sing:2007}).
It is easy to see that the word $(ab^{n-1})^{n-2}a$ of length
$n(n-2)+1=(n-1)^2$ resets $\mathcal{C}_n$.
\begin{proposition}[{\mdseries\cite[Lemma~1]{Cerny:1964}}]
\label{KV:prop:cerny} Any \sw\ for $\mathcal{C}_n$ has length at least
$(n-1)^2$.
\end{proposition}
There are several nice proofs for this result. Here we present a recent proof
from~\cite{Ananichev&Gusev&Volkov:2010}; it is based on a transparent idea and
reveals an interesting connection between \v{C}ern\'{y}'s automata
$\mathcal{C}_n$ and an extremal series of graphs discovered in Wielandt's
classic paper~\cite{Wielandt:1950} (see Section~\ref{KV:sec:rcp}).

\begin{proof}[Proof of Proposition~\ref{KV:prop:cerny}]
Let $w$ be a \sw\ of minimum length for $\mathcal{C}_n$. Since the letter $b$
acts on $Q$ as a cyclic permutation, the word $w$ cannot end with $b$.
(Otherwise removing the last letter gives a shorter \sw.) Thus, $w = w'a$ for
some $w'\in\{a,b\}^*$ such that the image of $Q$ under the action of $w'$ is
precisely the set $\{0,1\}$.

Since the letter $a$ fixes each state in its image $\{1,2,\dots,n-1\}$, every
occurrence of $a$ in $w$ except the last one is followed by an occurrence of
$b$. (Otherwise $a^2$ occurs in $w$ as a factor and reducing this factor to
just $a$ results in a shorter \sw.) Therefore, if we let $c=ab$, then the word
$w'$ can be rewritten into a word $v$ over the alphabet $\{b,c\}$. The actions
of $b$ and $c$ induce a new DFA on the state set $Q$; we denote this induced
DFA (shown in Figure~\ref{KV:fig:cerny-n} on the right) by $\mathcal{W}_n$.
Since $w'$ and $v$ act on $Q$ in the same way, the word $vc$ is a \sw\ for
$\mathcal{W}_n$ and brings the automaton to the state~2.

If $u\in\{b,c\}^*$, the word $uvc$ also is a \sw\ for $\mathcal{W}_n$ and it
also brings the automaton to~2. Hence, for every $\ell\ge|vc|$, there is a path
of length $\ell$ in $\mathcal{W}_n$ from any given state $i$ to~2. In
particular, setting $i=2$, we conclude that for every $\ell\ge|vc|$ there is a
cycle of length $\ell$ in $\mathcal{W}_n$. The underlying graph of
$\mathcal{W}_n$ has simple cycles only of two lengths: $n$ and $n-1$. Each
cycle of $\mathcal{W}_n$ must consist of simple cycles of these two lengths
whence each number $\ell\ge|w|$ must be expressible as a non-negative integer
combination of $n$ and $n-1$. Here we invoke the following well-known and
elementary result from arithmetics:

\begin{lemma}[{\mdseries\cite[Theorem 2.1.1]{RamirezAlfonsin:2005}}]
\label{KV:lemma:sylvester} If $k_1,k_2$ are relatively prime positive integers,
then $k_1k_2-k_1-k_2$ is the largest integer that is not expressible as a
non-negative integer combination of $k_1$ and $k_2$.\qed
\end{lemma}

Lemma~\ref{KV:lemma:sylvester} implies that
$|vc|>n(n-1)-n-(n-1)=n^2-3n+1$. Suppose that $|vc|=n^2-3n+2$. Then
there should be a path of this length from the state~1 to the
state~2. Every outgoing edge of~1 leads to~2, and thus, in the
path it must be followed by a cycle of length $n^2-3n+1$. No cycle
of such length may exist by Lemma~\ref{KV:lemma:sylvester}. Hence
$|vc|\ge n^2-3n+3$.

Since the action of $b$ on any set $S$ of states cannot change the
cardinality of $S$ and the action of $c$ can decrease the
cardinality by~1 at most, the word $vc$ must contain at least
$n-1$ occurrences of $c$. Hence the length of $v$ over $\{b,c\}$
is at least $n^2-3n+2$ and $v$ contain at least $n-2$ occurrences
of $c$. Since each occurrence of $c$ in $v$ corresponds to an
occurrence of the factor $ab$ in $w'$, we conclude that the length
of $w'$ over $\{a,b\}$ is at least $n^2-3n+2+n-2=n^2-2n$. Thus,
$|w|=|w'a|\ge n^2-2n+1=(n-1)^2$.
\end{proof}

If we define the \emph{\v{C}ern\'{y} function}\index{Cerny@\v{C}ern\'{y}
function} $\mathfrak{C}(n)$ as the maximum length of shortest reset words for
\sa\ with $n$ states, the above property of the series $\{\mathcal{C}_{n}\}$,
$n=2,3,\dotsc$, yields the inequality $\mathfrak{C}(n)\ge(n-1)^2$. The
\emph{\v{C}ern\'{y} conjecture}\index{Cerny@\v{C}ern\'{y} conjecture} is the
claim that the equality $\mathfrak{C}(n)=(n-1)^2$ holds true.

In the literature, one often refers to \v{C}ern\'{y}'s paper~\cite{Cerny:1964}
as the source of the \v{C}ern\'{y} conjecture. In fact, the conjecture was not
yet formulated in that paper. There \v{C}ern\'{y} only observed that
$(n-1)^2\le \mathfrak{C}(n)\le 2^n-n-1$ and concluded the paper with the
following remark:
\begin{quote}
``The difference between the bounds increases rapidly and it is necessary to
sharpen them. One can expect an improvement mainly for the upper bound.''
\end{quote}
The conjecture in its present-day form was formulated a bit later, after the
expectation in the above quotation was confirmed by \cite{Starke:1966}.
(Namely, Starke improved the upper bound from~\cite{Cerny:1964} to
$1+\frac{n(n-1)(n-2)}2$, which was the first polynomial upper bound for
$\mathfrak{C}(n)$.) \v{C}ern\'{y} explicitly stated the conjecture
$\mathfrak{C}(n)=(n-1)^2$ in his talks in the second half of the 1960s; in
print the conjecture first appeared in~\cite{Cerny&Piricka&Rosenauerova:1971}.

\paragraph*{An upper bound.} The best upper bound for the \v{C}ern\'{y}
function achieved so far guarantees that for every \san\ with $n$ states there
exists a reset word of length $\frac{n^3-n}6$. Such a reset word arises as the
output of the following greedy algorithm.\index{greedy algorithm!compression}

%=================================
\begin{algorithm}
  \setlength{\commentspace}{6cm}
  \begin{algorithmic}[1]
    \FUNC{GreedyCompression$(\mathcal{A})$}
    \STATE\algcomment{0}{Initializing the current word}$w\gets\varepsilon$
    \STATE\algcomment{0}{Initializing the current set}$P\gets Q$
    \WHILE{$|P|> 1$}
    \IF{$|P\cdot u|=|P|$ for all $u\in A^*$}
    \RETURN Failure
    \ELSE\STATE{}take a word $v\in A^*$ of minimum length with $|P\cdot v|<|P|$
    \ENDIF
    \STATE\algcomment{1}{Updating the current word}$w\gets wv$
    \STATE\algcomment{1}{Updating the current set}$P\gets P\cdot v$
    \ENDWHILE
    \RETURN $w$
  \end{algorithmic}
\caption{Compression algorithm calculating a \sw\ for
$\mathcal{A}=(Q,A)$}\label{KV:Greedy}
\end{algorithm}
%==================================

If $|Q|=n$, then clearly the main loop of Algorithm~\ref{KV:Greedy} is executed
at most $n-1$ times. Finding the word $v$ in line~7 amounts to reading the
labels along a shortest path between a couple contained in $P$ and a singleton
in the automaton $\mathcal{P}^{[2]}(\mathcal{A})$ (see the discussion after
Proposition~\ref{KV:prop:quadratic}). Breadth-first search does this in
$O(n^2\cdot|A|)$ time. Thus, Algorithm~\ref{KV:Greedy} is polynomial in the
size of $\mathcal{A}$. In order to evaluate the length of the output word $w$,
we estimate the length of each word $v$ produced by the main loop.

Consider a generic step at which $|P|=k>1$ and let $v=a_1\cdots a_\ell$ with
$a_i\in\Sigma$, $i=1,\dots,\ell$. Then each of the sets
\begin{displaymath}
P_1=P,\ P_2=P_1\cdot a_1,\ \dotsc,\ P_\ell=P_{\ell-1}\cdot a_{\ell-1}
\end{displaymath}
contains exactly $k$ states. Furthermore, since $|P_{\ell}\cdot
a_{\ell}|<|P_\ell|$, there exist two distinct states $p_\ell,p'_\ell\in P_\ell$
such that $p_{\ell}\cdot a_{\ell}=p'_{\ell}\cdot a_{\ell}$. Now define couples
$R_i=\{p_i,p'_i\}\subseteq P_i$, $i=1,\dots,\ell$, such that $p_i\cdot
a_i=p_{i+1}$, $p'_i\cdot a_i=p'_{i+1}$ for $i=1,\dots,\ell-1$.
\begin{figure}[ht]
\begin{center}
\unitlength=.7mm
\begin{picture}(85,37)\nullfont
\drawoval(0,18,15,38,5) \drawoval(25,18,15,38,5) \drawoval(80,18,15,38,5)
\gasset{Nadjust=wh,Nframe=n,Nfill=n} \node(A)(0,10){$p_1$}
\node(B)(0,26){$p'_1$} \node(C)(25,10){$p_2$} \node(D)(25,26){$p'_2$}
\node(E)(80,10){$p_\ell$} \node(F)(80,26){$p'_\ell$}
\node[Nframe=y](G)(105,18){} \drawedge(A,C){$a_1$} \drawedge(B,D){$a_1$}
\drawedge[ELside=r](E,G){$a_\ell$} \drawedge(F,G){$a_\ell$} \put(-13,2){$P_1$}
\put(12,2){$P_2$} \put(67,2){$P_\ell$} \node(C1)(48,10){} \node(D1)(48,26){}
\node(E0)(56,10){} \node(F0)(56,26){} \drawedge(C,C1){$a_2$}
\drawedge(D,D1){$a_2$} \drawedge(E0,E){$a_{\ell-1}$}
\drawedge(F0,F){$a_{\ell-1}$} \put(49,10){$\dots$} \put(49,26){$\dots$}
\end{picture}
\end{center}
\caption{Combinatorial configuration at a generic step of
Algorithm~\ref{KV:Greedy}}\label{KV:fig:combinatorial configuration}
\end{figure}

\noindent Then the condition that $v$ is a word of minimum length with $|P\cdot
v|<|P|$ implies that $R_i\nsubseteq P_j$ for $1\le j<i\le\ell$. Indeed, if
$R_i\subseteq P_j$ for some $j<i$, then already the word $a_1\cdots
a_ja_i\cdots a_\ell$ of length $j+\ell-i<\ell$ would satisfy $|P\cdot a_1\cdots
a_ja_i\cdots a_\ell|<|P|$ contradicting the choice of $v$. Thus, we arrive at a
problem from combinatorics of finite sets that can be stated as follows. Let
$1<k\le n$. A sequence of $k$-element subsets $P_1,P_2,\dots$ of an $n$-element
set is called 2-\emph{renewing}\index{2-renewing sequence} if each $P_i$
contains a couple $R_i$ such that $R_i\nsubseteq P_j$ for each $j<i$. What is
the maximum length of a 2-renewing sequence as a function of $n$ and $k$?

The problem was solved by Frankl~\cite{Frankl:1982} who proved the following
result\footnote{Actually Frankl~\cite{Frankl:1982} considered and solved a more
general problem concerning the maximum length of (analogously defined)
$m$-renewing sequences of $k$-element subsets in an $n$-element set for any
fixed $m\le k$.}.
\begin{proposition}
\label{KV:prop:frankl} The maximum length of a $2$-renewing sequence of
$k$-element subsets in an $n$-element set is equal to $\binom{n-k+2}2$.
\end{proposition}
Thus, if $\ell_k$ is the length of the word $v$ that Algorithm~\ref{KV:Greedy}
appends to the current word $w$ after the iteration step that the algorithm
enters while the current set $P$ contains $k$ states, then
Proposition~\ref{KV:prop:frankl} guarantees that $\ell_k\le\binom{n-k+2}2$.
Summing up all these inequalities from $k=n$ to $k=2$, one arrives at the
aforementioned bound
\begin{equation}
\label{KV:eq:pin} \mathfrak{C}(n)\le\dfrac{n^3-n}6.
\end{equation}
In the literature the bound~\eqref{KV:eq:pin} is usually attributed to Pin who
explained the above connection between Algorithm~\ref{KV:Greedy} and the
combinatorial problem on the maximum length of 2-renewing sequences and
conjectured the estimation $\binom{n-k+2}2$ for this length in his talk at the
Colloquium on Graph Theory and Combinatorics held in Marseille in 1981. (Frankl
learned this conjecture from Pin---and proved it---during another colloquium on
combinatorics held in Bielefeld in November 1981.) Accordingly, the usual
reference for~\eqref{KV:eq:pin} is the paper \cite{Pin:1983} based on the talk.
The full story is however more complicated. Actually, the
bound~\eqref{KV:eq:pin} first appeared in~\cite{Fischler&Tannenbaum:1970} where
it was deduced from a combinatorial conjecture equivalent to Pin's one. The
conjecture however remained unproved. The bound~\eqref{KV:eq:pin} then
reoccurred in~\cite{Kohavi&Winograd:1971,Kohavi&Winograd:1973} but the argument
justifying it in these papers was insufficient. In 1987 both~\eqref{KV:eq:pin}
and Proposition~\ref{KV:prop:frankl} were independently rediscovered by
Klyachko, Rystsov and Spivak~\cite{Klyachko&Rystsov&Spivak:1987} who were aware
of~\cite{Fischler&Tannenbaum:1970,Kohavi&Winograd:1971,Kohavi&Winograd:1973}
but
neither~\cite{Pin:1983} nor~\cite{Frankl:1982}.\marginpar{\textbf{If space\\
permits!!}} We include here a proof of Frankl's result
following~\cite{Klyachko&Rystsov&Spivak:1987}.

\begin{proof}[Proof of Proposition~\ref{KV:prop:frankl}] Let $Q=\{1,2,\dots,n\}$.
First, we exhibit a 2-renewing sequence of $k$-element subsets in $Q$ of length
$\binom{n-k+2}2$. For this put $W=\{1,\dots,k-2\}$, list all $\binom{n-k+2}2$
couples of $Q\setminus W$ in some order and let $T_i$ be the union of $W$ with
the $i$-th couple in the list. Clearly, the sequence
$T_1,\dots,T_{\binom{n-k+2}2}$ is 2-renewing.

Now we assign to each $k$-element subset $S=\{s_1,\dots,s_k\}$ of $Q$ the
following polynomial $D(S)$ in variables $x_{s_1},\dots,x_{s_k}$ over the field
$\mathbb{R}$ of reals:
\begin{displaymath}
D(S)=\begin{vmatrix}
1 & s_1 & s_1^2 & \cdots & s_1^{k-3} & x_{s_1} & x_{s_1}^2\\
1 & s_2 & s_2^2 & \cdots & s_2^{k-3} & x_{s_2} & x_{s_2}^2\\
\vdots & \vdots & \vdots & \ddots & \vdots & \vdots & \vdots\\
1 & s_k & s_k^2 & \cdots & s_k^{k-3} & x_{s_k} & x_{s_k}^2
\end{vmatrix}_{k\times k}.
\end{displaymath}
Observe that for any 2-renewing sequence $S_1,\dots,S_\ell$ of $k$-element
subsets in $Q$, the polynomials $D(S_1),\dots,D(S_\ell)$ are linearly
independent. Indeed, if they were linearly dependent, then by a basic lemma of
linear algebra, some polynomial $D(S_j)$ should be expressible as a linear
combination of the preceding polynomials $D(S_1),\dots,D(S_{j-1})$. By the
definition of a 2-renewing sequence, $S_j$ contains a couple $\{s,s'\}$ such
that $\{s,s'\}\nsubseteq S_i$ for all $i<j$. If we substitute $x_s=s$,
$x_{s'}=s'$ and $x_t=0$ for $t\ne s,s'$ in each polynomial
$D(S_1),\dots,D(S_j)$, then the polynomials $D(S_1),\dots,D(S_{j-1})$ vanish
(since the two last columns in each of the resulting determinants become
proportional) and so does any linear combination of the polynomials. The value
of $D(S_j)$ however is the determinant being the product of a Vandermonde
$(k-2)\times(k-2)$-determinant with the $2\times 2$-determinant $\begin{vmatrix} s & s^2\\
s' & (s')^2\end{vmatrix}$, whence this value is not 0. Hence $D(S_j)$ cannot be
equal to a linear combination of $D(S_1),\dots,D(S_{j-1})$.

We see that the length of any 2-renewing sequence cannot exceed the dimension
of the linear space over $\mathbb{R}$ spanned by all polynomials of the form
$D(S)$. In order to prove that the dimension is at most $\binom{n-k+2}2$, it
suffices to show that the space is spanned by the polynomials
$D(T_1),\dots,D(T_{\binom{n-k+2}2})$, where $T_1,\dots,T_{\binom{n-k+2}2}$ is
the 2-renewing sequence constructed in the first paragraph of the proof. For
this, take an arbitrary $k$-element subset $S=\{s_1,\dots,s_k\}$ of $Q$. We
claim that the polynomial $D(S)$ is a linear combination of
$D(T_1),\dots,D(T_{\binom{n-k+2}2})$. We induct on the cardinality of the set
$S\setminus W$. If $|S\setminus W|=2$, then $S$ is the union of $W$ with some
couple from $Q\setminus W$, whence $S=T_i$ for some $i=1,\dots,\binom{n-k+2}2$.
Thus, $D(S)=D(T_i)$ and our claim holds true. If $|S\setminus W|>2$, there is
$s_0\in W\setminus S$. Let $S'=S\cup\{s_0\}$. There exists a polynomial
$p(x)=\alpha_0+\alpha_1x+\alpha_2x^2\cdots+\alpha_{k-3}x^{k-3}$ over
$\mathbb{R}$ such that $p(s_0)=1$ and $p(s)=0$ for all $s\in
W\setminus\{s_0\}$. Consider the determinant
\begin{displaymath}
\Delta=\begin{vmatrix}
p(s_0) & 1 & s_0 & s_0^2 & \cdots & s_0^{k-3} & x_{s_0} & x_{s_0}^2\\
p(s_1) & 1 & s_1 & s_1^2 & \cdots & s_1^{k-3} & x_{s_1} & x_{s_1}^2\\
p(s_2) & 1 & s_2 & s_2^2 & \cdots & s_2^{k-3} & x_{s_2} & x_{s_2}^2\\
\vdots & \vdots & \vdots & \vdots & \ddots & \vdots & \vdots & \vdots\\
p(s_k) & 1 & s_k & s_k^2 & \cdots & s_k^{k-3} & x_{s_k} & x_{s_k}^2
\end{vmatrix}_{(k+1)\times (k+1)}.
\end{displaymath}
Clearly, $\Delta=0$ as the first column is the sum of the next $k-2$ columns
with the coefficients $\alpha_0,\alpha_1,\alpha_2,\dots,\alpha_{k-3}$. Thus,
expanding $\Delta$ by the first column gives the identity
\begin{displaymath}
\sum_{j=0}^{k}(-1)^jp(s_j)D(S'\setminus\{s_j\})=0.
\end{displaymath}
Since $p(s_0)=1$ and $S'\setminus\{s_0\}=S$, the identity rewrites as
\begin{equation}
\label{KV:eq:combination}
D(S)=\sum_{j=1}^{k}(-1)^{j+1}p(s_j)D(S'\setminus\{s_j\}),
\end{equation}
and since $p(s)=0$ for all $s\in W\setminus\{s_0\}$ all the non-zero summands
in the right-hand side are such that $s_j\notin W$. For each such $s_j$, we
have
\begin{displaymath}
(S'\setminus\{s_j\})\setminus
W=S'\setminus(W\cup\{s_j\})=(S\cup\{s_0\})\setminus(W\cup\{s_j\})=(S\setminus
W)\setminus\{s_j\},
\end{displaymath}
whence $|(S'\setminus\{s_j\})\setminus W|=|S\setminus W|-1$ and by the
inductive assumption, the polynomials $D(S'\setminus\{s_j\})$ are linear
combinations of $D(T_1),\dots,D(T_{\binom{n-k+2}2})$. From
\eqref{KV:eq:combination} we conclude that this holds true for the polynomial
$D(S)$ as well.
\end{proof}

If one executes Algorithm~\ref{KV:Greedy} on the \v{C}ern\'{y} automaton
$\mathcal{C}_{4}$ (Figure~\ref{KV:fig:power automaton} is quite helpful here),
one sees that the algorithm returns the word $ab^2abab^3a$ of length 10 which
is not the shortest reset word for $\mathcal{C}_{4}$. This reveals one of the
main intrinsic difficulties of the synchronization problem: the standard
optimality principle does not apply here since it is not true that the optimal
solution behaves optimally also in all intermediate steps. In our example, the
optimal solution is the word $ab^3ab^3a$ but it cannot be found by
Algorithm~\ref{KV:Greedy} because the algorithm chooses $v=b^2a$ rather than
$v=b^3a$ on the second execution of the main loop. Actually, the gap between
the \rt\ of a \san\ and the length of the \sw\ that Algorithm~\ref{KV:Greedy}
returns on the automaton may be arbitrarily large\footnote{We observe that this
does not immediately follow from the non-approximation results discussed in
Section~\ref{KV:sec:algorithms&complexity} because Algorithm~\ref{KV:Greedy} is
not really deterministic. Indeed, in general there may be several words
satisfying the conditions in line~7 of the algorithm and it has not been
specified which one of the words should be taken.}: one can calculate that for
the \v{C}ern\'{y} automaton $\mathcal{C}_{n}$ whose \rt\ is $(n-1)^2$,
Algorithm~\ref{KV:Greedy} produces a \sw\ of length $\Omega(n^2\log n)$. The
behaviour of Algorithm~\ref{KV:Greedy} on average is not yet understood;
practically it behaves rather well.

\paragraph*{The extension algorithm.} While studying Algorithm~\ref{KV:Greedy}
has provided the best currently known upper bound for the \v{C}ern\'{y}
function in the general case, the most impressive partial results proving the
\v{C}ern\'{y} conjecture for some special classes of automata have been
obtained via analysis a different algorithm. This algorithm also operates in a
greedy manner but builds a \sw\ in the opposite direction.\index{greedy
algorithm!extension}

For a DFA $\mathcal{A}=(Q,A)$, a subset $P\subseteq Q$ and a word $w\in A^*$,
we denote by $Pw^{-1}$ the full pre-image of $P$ under the action of $w$, that
is, $Pw^{-1}=\{q\in Q\mid q\cdot w\in P\}$. In what follows, we denote the same
a singleton set and its single element to lighten notation.

%=================================
\begin{algorithm}
  \setlength{\commentspace}{6cm}
  \begin{algorithmic}[1]
    \FUNC{GreedyExtenstion$(\mathcal{A})$}
    \IF{$|qa^{-1}|=1$ for all $q\in Q$ and $a\in A$}
    \RETURN Failure
    \ELSE\STATE \algcomment{0}{Initializing the current word}$w\gets a$ such
    that $|qa^{-1}|>1$
    \STATE\algcomment{0}{Initializing the current set}$P\gets qa^{-1}$ such
    that $|qa^{-1}|>1$
    \ENDIF
    \WHILE{$|P|<|Q|$}
    \IF{$|Pu^{-1}|\le|P|$ for all $u\in A^*$}
    \RETURN Failure
    \ELSE\STATE{}take a word $v\in A^*$ of minimum length with $|Pv^{-1}|>|P|$
    \ENDIF
    \STATE\algcomment{1}{Updating the current word}$w\gets vw$
    \STATE\algcomment{1}{Updating the current set}$P\gets Pv^{-1}$
    \ENDWHILE
    \RETURN $w$
  \end{algorithmic}
\caption{Extension algorithm calculating a \sw\ for
$\mathcal{A}=(Q,A)$}\label{KV:Extension}
\end{algorithm}
%==================================

In contrast to Algorithm~\ref{KV:Greedy}, it is not clear whether
Algorithm~\ref{KV:Extension} admits a polynomial-time implementation. Moreover,
in general we know no non-trivial bound on the length of the words $v$ that the
main loop of Algorithm~\ref{KV:Extension} appends to the current word. However,
one can isolate some cases in which rather strong bounds on $|v|$ do exist. The
following definition is convenient for subsequent discussion. Given a number
$\alpha>0$, a DFA $\mathcal{A}=(Q,A)$ is said to be
$\alpha$-\emph{extensible}\index{automaton!$\alpha$-extensible} if for each
proper non-singleton subset $S\subset Q$, there exists a word $u\in A^*$ of
length at most $\alpha|Q|$ such that $|Su^{-1}|>|S|$. The following observation
explains the importance of this property.

\begin{proposition}
\label{KV:prop:extensibility} If $\mathcal{A}$ is an $\alpha$-extensible
automaton with $n$ states, then $\mathcal{A}$ is synchronizing and the \rt\ of
$\mathcal{A}$ is at most $1+\alpha n(n-2)$. In particular, the \v{C}ern\'{y}
conjecture holds true for $1$-extensible automata.
\end{proposition}

\begin{proof}
If we run Algorithm~\ref{KV:Extension} on $\mathcal{A}$, the main loop is
executed at most $n-2$ times and each word that it appends to the current word
has length at most $\alpha n$. Hence the length of the \sw\ returned by the
algorithm does not exceed $1+\alpha n(n-2)$. If $\alpha=1$, then we get the
bound $1+n(n-2)=(n-1)^2$ which complies with the \v{C}ern\'{y} conjecture.
\end{proof}

The approach to the \v{C}ern\'{y} conjecture via extensibility traces back to
Pin's paper~\cite{Pin:1978} of 1978. Pin observed that every DFA
$\mathcal{A}=(Q,A)$ such that $|Q|$ is prime and some letter acts as a cyclic
permutation of $Q$ is 1-extensible provided some other letter acts on $Q$ as a
non-permutation. Thus, such $\mathcal{A}$ is synchronizing and its \rt\ does
not exceed $(|Q|-1)^2$. 20 years later Dubuc~\cite{Dubuc:1998} generalized
Pin's result by showing that every \sa\ in which some letter acts as a cyclic
permutation of the state set is 1-extensible. Kari~\cite{Kari:2003} proved
1-extensibility of Eulerian\footnote{A graph is  \emph{strongly connected} if
for every pair of its vertices, there exists a path from one to the other. A
graph is \emph{Eulerian} if it is strongly connected and each of its vertices
serves as the tail and as the head for the same number of edges. A DFA is said
to be \emph{Eulerian} if so is its underlying graph. More generally, we freely
transfer graph notions (such as strong connectivity) from graphs to automata
they underlie.} \sa. In all these papers 1-extensibility is obtained via
linear-algebraic arguments;\marginpar{\textbf{If space\\
permits!!}} we include here a proof from~\cite{Kari:2003} as quite a
representative example of these linearization techniques.

\begin{theorem}[{\mdseries\cite[Theorem~2]{Kari:2003}}]
\label{KV:thm:eulerian} If a \san\ $\mathcal{A}=(Q,A)$ is Eulerian, then it has
a \sw\ of length at most $(n-2)(n-1)+1$, where $n=|Q|$.
\end{theorem}

\begin{proof}
For every vertex in an Eulerian graph, its in-degree and its out-degree are
equal. In the underlying graph of a DFA the out-degree of every vertex is equal
to the cardinality of the input alphabet. Hence, if $|A|=k$, then each vertex
in the underlying graph of $\mathcal{A}$ has in-degree $k$ and for every subset
$P\subseteq Q$, the equality
\begin{equation}
\label{KV:eq:eulerian} \sum_{a\in A}|Pa^{-1}|=k|P|
\end{equation}
holds true since the left-hand side of \eqref{KV:eq:eulerian} is the number of
edges in the underlying graph of $\mathcal{A}$ with ends in $P$. The equality
\eqref{KV:eq:eulerian} readily implies that for each $P\subseteq Q$, one of the
following alternatives takes place: either $|Pa^{-1}|=|P|$ for all letters
$a\in A$ or $|Pb^{-1}|>|P|$ for some $b\in A$. Now assume that a subset
$S\subseteq Q$ and a word $u\in A^+$ are such that $|Su^{-1}|\ne|S|$ and $u$ is
a word of minimum length with this property. We write $u=aw$ for some $a\in A$
and $w\in A^*$ and let $P=Sw^{-1}$. Then $|P|=|S|$ by the choice of $u$ and
$Pa^{-1}=Su^{-1}$ whence $|Pa^{-1}|\ne|P|$. Thus, $P$ must fall into the second
of the above alternatives and so $|Pb^{-1}|>|P|$ for some $b\in A$. The word
$v=bw$ has the same length as $u$ and has the property that $|Sv^{-1}|>|S|$.
Having this in mind, we now aim to prove that for every proper subset $S\subset
Q$, there exists a word $u\in A^*$ of length at most $n-1$ such that
$|Su^{-1}|\ne|S|$.

It is here where linear algebra comes into the play. We may assume that
$Q=\{1,2,\dots,n\}$. Assign to each subset $P\subseteq Q$ its
\emph{characteristic vector}\index{characteristic vector} $[P]$ in the linear
space $\mathbb{R}^n$ of $n$-dimensional row vectors over $\mathbb{R}$ as
follows: $i$-th entry of $[P]$ is 1 if $i\in P$, otherwise it is equal to 0.
For instance, $[Q]$ is the all ones row vector and the vectors $[1],\dots,[n]$
form the standard basis of $\mathbb{R}^n$. Observe that for any vector
$x\in\mathbb{R}^n$, the inner product $\langle x,[Q]\rangle$ is equal to the
sum of all entries of $x$. In particular, for each subset $P\subseteq Q$, we
have $\langle[P],[Q]\rangle=|P|$. Further, assign to each word $w\in A^*$ the
linear operator $\varphi_w$ on $\mathbb{R}^n$ defined by
$\varphi_w([i])=[iw^{-1}]$ for each $i\in Q$. It is then clear that
$\varphi_w([P])=[Pw^{-1}]$ for each $P\subseteq Q$.

The inequality $|Su^{-1}|\ne|S|$ that we look for can be rewritten as
$\langle\varphi_u([S]),[Q]\rangle\ne\langle[S],[Q]\rangle$ or
$\langle\varphi_u([S])-[S],[Q]\rangle\ne0$. Let $x=[S]-\frac{|S|}n[Q]$. Then
$x\ne0$ as $S\ne Q$ and $\langle x,[Q]\rangle=0$. Since $Qu^{-1}=Q$ for every
word $u$, we have $\varphi_u([Q])=[Q]$. Hence
\begin{multline*}
\langle\varphi_u([S])-[S],[Q]\rangle=\langle\varphi_u(x+\frac{|S|}n[Q])-(x+\frac{|S|}n[Q]),[Q]\rangle=\\
\langle\varphi_u(x)+\frac{|S|}n[Q]-x-\frac{|S|}n[Q]),[Q]\rangle=\langle\varphi_u(x)-x,[Q]\rangle=
\langle\varphi_u(x),[Q]\rangle.
\end{multline*}
Thus, a word $u$ satisfies $|Su^{-1}|\ne|S|$ if and only if the vector
$\varphi_u(x)$ lies beyond the subspace $U$ of all vectors orthogonal to $[Q]$.
We aim to bound the minimum length of such word $u$ but
first we explain why words sending $x$ beyond $U$ exist.\marginpar{\textbf{There is a\\
bug in~\cite{Kari:2003}\\ in this place}} Since the automaton $\mathcal{A}$ is
synchronizing and strongly connected (as it is Eulerian), there exists a word
$w\in A^*$ such that $Q\cdot w\subseteq S$---one can first synchronize
$\mathcal{A}$ to a state $q$ and then move $q$ into $S$ by applying a word that
labels a path from $q$ to a state in $S$. Then
\begin{displaymath}
\varphi_w(x)=\varphi_w([S]-\frac{|S|}n[Q])=\varphi_w([S])-\frac{|S|}n\varphi_w([Q])=
(1-\frac{|S|}n)[Q]\ne0.
\end{displaymath}

Now consider the chain of subspaces $U_0\subseteq U_1\subseteq\dotsc$, where
$U_j$ is spanned by all vectors of form $\varphi_w(x)$ with $|w|\le j$.
Clearly, if $U_{j+1}=U_j$ for some $j$ then $\varphi_a(U_j)\subseteq U_j$ for
all $a\in A$ whence $U_i=U_j$ for every $i\ge j$. Let $\ell$ be the least
number such that $\varphi_u(x)\notin U$ for some word $u$ of length $\ell$,
that is, the smallest $\ell$ such that $U_\ell\nsubseteq U$. Then in the chain
$U_0\subseteq U_1\subseteq\dots\subseteq U_\ell$ all inclusions are strict
whence
\begin{displaymath}
1=\dim U_0 < \dim U_1 <\dots<\dim U_{\ell-1}<\dim U_\ell
\end{displaymath}
and, in particular, $\dim U_{\ell-1}\ge\ell$. But by our choice of $\ell$ we
have $U_{\ell-1}\subseteq U$ whence $\dim U_{\ell-1}\le \dim U$. Since $U$ is
the orthogonal complement of a 1-dimensional subspace, $\dim U=n-1$, and we
conclude that $\ell\le n-1$.

As shown in the first paragraph of the proof, the above implies that for every
proper subset $S\subset Q$, there exists a word $u\in A^*$ of length at most
$n-1$ such that $|Su^{-1}|>|S|$. Then Algorithm~\ref{KV:Extension} run on
$\mathcal{A}$ returns a \sw\ of length at most $(n-2)(n-1)+1$.
\end{proof}

We mention in passing that the upper bound provided by
Theorem~\ref{KV:thm:eulerian} is far from being tight. So far experiments have
discovered no Eulerian \san\ $(n\ge4)$ with $n$ states whose \rt\ would exceed
$\lfloor\frac{n^2-5}2\rfloor$.

Return to our discussion of extensibility. Even though the approach to the
\v{C}ern\'{y} conjecture via 1-exten\-sibil\-ity has proved to be productive in
several special cases, it cannot resolve the general case because there exist
\sa\ that are not 1-extensible. The first example here was the 6-state
automaton $\mathcal{K}_6$\index{automaton!Kari} discovered by
Kari~\cite{Kari:2001}, see Figure~\ref{KV:fig:Kari}. This automaton is
synchronizing with \rt\ 25, the shortest \sw\ being
$ba(ab)^3a^2b(ba)^3ab(ba^2)ab$. Kari found $\mathcal{K}_6$ as a counter example
to a generalized form of the \v{C}ern\'{y} conjecture proposed in Pin's thesis
\cite{Pin:1978a} but the automaton is remarkable in several other respects.
\begin{figure}[tbh]
\begin{center}
\unitlength=0.85mm
\begin{picture}(80,55)(0,5)
\node(A)(0,50){0} \node(B)(30,50){1} \node(C)(60,50){2} \node(D)(60,20){3}
\node(E)(30,20){4} \node(F)(0,20){5} \drawedge[ELside=r](A,B){$a$}
\drawedge[ELside=r](B,C){$a$} \drawedge[ELside=r,curvedepth=-7](C,A){$a$}
\drawedge[ELside=r](F,E){$a$} \drawedge[ELside=r](E,D){$a$}
\drawedge[curvedepth=7](D,F){$a$} \drawedge[ELside=r,curvedepth=-3](D,C){$b$}
\drawedge[ELside=r,curvedepth=-3](C,D){$b$} \drawedge(E,C){$b$}
\drawloop[loopangle=-90](B){$b$} \drawloop[loopangle=180](A){$b$}
\drawloop[loopangle=180](F){$b$}
\end{picture}
\caption{Kari's automaton $\mathcal{K}_6$}\label{KV:fig:Kari}
\end{center}
\end{figure}
In particular, one can verify that no word $v$ of length~6 or~7 is such that
the full pre-image of the set $\{2,3,4,5\}$ under the action of $v$ has more
than 4 elements.

Recently Berlinkov~\cite{Berlinkov:2010a} has constructed a series of \sa\ that
for each $\alpha<2$ contains an automaton that is not $\alpha$-extensible. The
question of whether or not all \sa\ are 2-extensible remains open.
2-extensibility (and thus---by Proposition~\ref{KV:prop:extensibility}---a
quadratic in the state number upper bound for the \rt) has been established for
several classes of \sa\ by
Rystsov~\cite{Rystsov:1995a,Rystsov:1995,Rystsov:2000}.

Recently a slightly relaxed version of 2-extensibility has been verified by
B\'eal, Ber\-lin\-kov and
Perrin~\cite{Beal&Perrin:2009,Beal&Berlinkov&Perrin:2011} for the important
class of the so-called one-cluster automata. A DFA $\mathcal{A}=(Q,A)$ is
called \emph{one-cluster}\index{automaton!one-cluster} if there exist a letter
$a\in A$ that labels only one simple cycle. (For instance, the automata
$\mathcal{C}_n$ and $\mathcal{W}_n$ shown in Figure~\ref{KV:fig:cerny-n} are
one-cluster while Kari's automaton $\mathcal{K}_6$ shown in
Figure~\ref{KV:fig:Kari}, is not. A mass example of one-cluster automata is
provided by the decoders of finite maximal prefix codes discussed in
Section~\ref{KV:sec:motivation}.) If $C$ is this cycle, then it is easy to see
that $Q\cdot a^{|Q|-|C|}=C$, and one can modify Algorithm~\ref{KV:Extension} as
follows.

%=================================
\begin{algorithm}
  \setlength{\commentspace}{6cm}
  \begin{algorithmic}[1]
    \FUNC{RelativeExtenstion$(\mathcal{A},C,a)$}
    \STATE \algcomment{0}{Initializing the current word}$w\gets\varepsilon$
    \STATE\algcomment{0}{Initializing the current set}$P\gets \{q\}$ where $q\in C$
    \WHILE{$|P|<|C|$}
    \IF{$|Pu^{-1}\cap C|\le|P|$ for all $u\in A^*$}
    \RETURN Failure
    \ELSE\STATE{}take a word $v\in A^*$ of minimum length with $|Pv^{-1}\cap C|>|P|$
    \ENDIF
    \STATE\algcomment{1}{Updating the current word}$w\gets vw$
    \STATE\algcomment{1}{Updating the current set}$P\gets Pv^{-1}\cap C$
    \ENDWHILE
    \RETURN $a^{|Q|-|C|}w$
  \end{algorithmic}
\caption{Modified extension algorithm for a one-cluster automaton
$\mathcal{A}=(Q,A)$ with $C$ being a unique simple cycle labelled $a$
}\label{KV:One-cluster}
\end{algorithm}
%==================================

In~\cite{Beal&Perrin:2009,Beal&Berlinkov&Perrin:2011} it has been shown that
the length of each word $v$ appended by the main loop of
Algorithm~\ref{KV:One-cluster} does not exceed $2|Q|$, and this clearly implies
a quadratic in $|Q|$ upper bound on the \rt\ for one-cluster \sa. A similar
result has been obtained by Carpi and
D'Alessandro~\cite{Carpi&D'Alessandro:2009}.
Steinberg~\cite{Steinberg:2010,Steinberg:2010archive} has generalized the above
approach and slightly improved the upper bound. Namely, Steinberg has proved
that a one-cluster \san\ with $n$ states has a \sw\ of length at most
$2n^2-9n+14$. He also has verified the \v{C}ern\'y conjecture for one-cluster
\sa\ with $a$-cycles of prime cardinality.


%=====================================================
\section{The Road Coloring Problem}
\label{KV:sec:rcp}
%=====================================================

A graph $\Gamma$ in which each vertex has the same out-degree (say, $k$) is
called a \emph{graph of constant outdegree}\index{graph!of constant outdegree}
and the number $k$ is referred to as the outdegree of $\Gamma$. If we take an
alphabet $A$ whose of size is equal to the outdegree of $\Gamma$, then we can
label the edges of $\Gamma$ by letters of $A$ such that the resulting automaton
will be complete and deterministic. Any DFA obtained this way is referred to as
a \emph{coloring}\index{coloring (of a graph)} $\Gamma$.

Given a graph, it is reasonable to ask under which conditions it admits a
coloring satisfying some ``good'' properties. In this section we analyze the
so-called \emph{Road Coloring Problem}\index{Road Coloring Problem} that is
certainly the most famous question within this framework. The Road Coloring
Problem asks under which conditions graphs of constant outdegree admit a
synchronizing coloring.

The problem was explicitly stated by Adler, Goodwyn and
Weiss~\cite{Adler&Goodwyn&Weiss:1977} in 1977; in an implicit form it was
present already in an earlier memoir by Adler and
Weiss~\cite{Adler&Weiss:1970}. Adler, Goodwyn and Weiss considered only \scn\
graphs; as we shall see below this is quite a natural assumption since the
general case easily reduces to the case of \scn\ graphs. The name of the
problem suggested in~\cite{Adler&Goodwyn&Weiss:1977} comes from the following
interpretation. In every \scn \san\ $\mathcal{A}=(Q,A)$, one can assign to
state $q\in Q$ an instruction (a \sw) $w_q$ such that following $w_q$ one will
surely arrive at $q$ from any initial state. (Indeed, for this one should first
follow an arbitrary \sw\ leading to some state $p$, say, and then follow a word
that labels a path connecting $p$ and $q$---such a path exists because of
strong connectivity.) Thus, in order to help a traveler lost on a given \scn\
graph $\Gamma$ of constant outdegree to find his/her way from wherever he/she
could be, we should if possible color (that is, label) the edges of $\Gamma$
such that $\Gamma$ becomes a \san\ and then tell the traveler the magic
sequence of colors representing a \sw\ leading to the traveler's destination.

The original motivation in~\cite{Adler&Weiss:1970,Adler&Goodwyn&Weiss:1977}
came from symbolic dynamics. However, the Road Coloring Problem is quite
natural also from the viewpoint of the ``reverse engineering'' of \sa: we aim
to relate geometric properties of graphs to combinatorial properties of
automata built on those graphs.

The following necessary condition was found in~\cite{Adler&Goodwyn&Weiss:1977}:
\begin{proposition}
\label{KV:prop:primitivity} If a \scn\ graph $\Gamma$ admits a synchronizing
coloring, then the g.c.d. of lengths of all cycles in $\Gamma$ is equal to $1$.
\end{proposition}

\begin{proof}
Arguing by contradiction, let $k>1$ be a common divisor of lengths of the
cycles in $\Gamma$. Let $V$ denote the vertex set of $\Gamma$. Take a~vertex
$v_0\in V$ and, for $i=0,1,\dots,k-1$, let
$$V_i=\{v\in V\mid \text{there exists a path from } v_0 \text{ to } v \text{ of length }
i\!\!\pmod{k}\}.$$ Clearly, $V=\bigcup\limits_{i=0}^{k-1} V_i$. We claim that
$V_i\cap V_j=\varnothing$ if $i\ne j$.

Let $v\in V_i\cap V_j$ where $i\ne j$. This means that in $\Gamma$ there are
two paths from $v_0$ to $v$: of length $\ell\equiv i\!\!\pmod{k}$ and of length
$m\equiv j\!\!\pmod{k}$. Since $\Gamma$ is \scn, there exists also a path from
$v$ to $v_0$ of length $n$, say. Combining it with each of the two paths above
we get a cycle of length $\ell+n$ and a cycle of length $m+n$. Since $k$
divides the length of any cycle in $\Gamma$, we have $\ell+n\equiv i+n\equiv
0\!\!\pmod{k}$ and $m+n\equiv j+n\equiv 0\!\!\pmod{k}$, whence $i\equiv
j\!\!\pmod{k}$, a contradiction.

Thus, $V$ is a disjoint union of $V_0,V_1,\dots,V_{k-1}$, and by the definition
each edge in $\Gamma$ leads from $V_i$ to $V_{i+1\!\!\pmod{k}}$. Then $\Gamma$
definitely cannot be converted into a \san\ by any coloring of its edges: no
paths of the same length $\ell$ originated in $V_0$ and $V_1$ can terminate in
the same vertex because they end in $V_{\ell\!\!\pmod{k}}$ and in
$V_{\ell+1\!\!\pmod{k}}$ respectively.
\end{proof}

Graphs satisfying the conclusion of Proposition~\ref{KV:prop:primitivity} are
called \emph{primitive}\footnote{In the literature such graphs are sometimes
called \emph{aperiodic}. The term ``primitive'' comes from the notion of a
primitive matrix in the Perron-Frobenius theory of non-negative matrices: it is
known (and easy to see) that a graph is primitive if and only if so is its
incidence matrix.}.\index{graph!primitive} Adler, Goodwyn and
Weiss~\cite{Adler&Goodwyn&Weiss:1977} conjectured that primitivity is not only
necessary for a graph to have a synchronizing coloring but also sufficient. In
other word, they suggested the following \emph{Road Coloring
Conjecture}\index{Road Coloring Conjecture}: every \scn\ primitive graph with
constant out-degree admits a synchronizing coloring.

The Road Coloring Conjecture has attracted much attention. There were several
interesting partial results (see, e.g.,
\cite{O'Brien:1981,Friedman:1990,Perrin&Schutzenberger:1992,Jonoska&Suen:1995,Carbone:2001,Kari:2002,Kari:2003}),
and finally the problem was solved (in the affirmative) in August 2007 by
Trahtman~\cite{Trahtman:2009}.

Trahtman's proof heavily depends on a neat idea of \emph{stability} which is
due to Culik, Karhum\"aki and Kari~\cite{Culik&Karhumaki&Kari:2002}. Let
$\mathcal{A}=(Q,A)$ be a DFA. We define the \emph{stability
relation}\index{stability relation} $\sim$ on $Q$ as follows:
$$q\sim q' \Longleftrightarrow\forall u\in A^*\ \exists v\in A^*\ \ q\cdot uv=q'\cdot uv.$$
Any pair $(q,q')$ such that $q\ne q'$ and $q\sim q'$ is called
\emph{stable}.\index{stable pair} The key observation by Culik, Karhum\"aki and
Kari~\cite{Culik&Karhumaki&Kari:2002} was the following:

\begin{proposition}
\label{KV:prop:ckk} If every \scn\ primitive graph with constant out-degree and
more than one vertex has a coloring with a stable pair of vertices, then the
Road Coloring Conjecture is true.
\end{proposition}

\begin{proof}
Let $\Gamma$ be a \scn\ primitive graph with constant out-degree. We show that
$\Gamma$ has a synchronizing coloring by induction on the number of vertices in
$\Gamma$. If $\Gamma$ has only one vertex, there is nothing to prove. If
$\Gamma$ has more than one vertex, then it admits a coloring with a stable pair
of states by the letters of some alphabet $A$. Let $\mathcal{A}$ be the
automaton resulting from this coloring. It is easy to check that the stability
relation is a congruence of $\mathcal{A}$. Since the relation is non-trivial,
the quotient automaton $\mathcal{A}/\!{\sim}$ has fewer vertices. It is clear
that $\mathcal{A}/\!{\sim}$ is \scn, moreover, since each cycle in
$\mathcal{A}$ induces a cycle of the same length in $\mathcal{A}/\!\sim$, the
underlying graph of the latter automaton is primitive as well. Therefore, the
graph admits a synchronizing coloring by the induction assumption. We lift this
coloring to a coloring of $\Gamma$ in the following natural way. Every
transition $p\xrightarrow{a}q$ in the automaton $\mathcal{A}$ induces the
transition $[p]\xrightarrow{a}[q]$ in $\mathcal{A}/\!{\sim}$ (here $[p]$ and
$[q]$ stand for the $\sim$-classes of the vertices $p$ and respectively $q$).
Now, if the transition $[p]\xrightarrow{a}[q]$ is being recolored to
$[p]\xrightarrow{a'}[q]$ for some $a'\in A$, then the transition
$p\xrightarrow{a}q$ becomes $p\xrightarrow{a'}q$. A crucial feature of this
recoloring procedure is that it is consistent with the stability relation
$\sim$ in the following sense. Suppose $p\xrightarrow{a}q$ and
$p'\xrightarrow{a}q'$ are two transitions with the same label in $\mathcal{A}$
such that $p\sim p'$ and $q\sim q'$. Then $[p]=[p']$, $[q]=[q']$ and the two
transitions induce the same transition $[p]\xrightarrow{a}[q]$ in
$\mathcal{A}/\!{\sim}$. If it is being recolored to $[p]\xrightarrow{a'}[q]$
for some $a'\in A$, then the two transitions are being changed in the same way
such that the resulting transitions $p\xrightarrow{a'}q$ and
$p'\xrightarrow{a'}q'$ still have a common label.

Let $\mathcal{B}$ be the automaton resulting from the described recoloring; we
want to show that $\mathcal{B}$ is synchronizing. Take a \sw\ $w$ for the
synchronizing coloring of $\Gamma/\!\!\!\sim$ that we started with. If we apply
$w$ to the states of the automaton $\mathcal{B}$, it will lead them all into a
set $S$ that is contained in a single class of the relation $\sim$. We induct
on $|S|$. If $|S|=1$, then $w$ is a \sw\ for $\mathcal{B}$. If $|S|>1$, take
two states $q,q'\in S$. Since they form a stable pair in $\mathcal{A}$, there
exists a word $v$ such that $q\cdot_{\mathcal{A}}v=q'\cdot_{\mathcal{A}}v$.
(Here and below subscripts indicate the automaton in which paths are being
considered.) As discussed above, since $q\sim q'$, the paths started at $q$ and
$q'$ and labelled $v$ in $\mathcal{A}$ have a common label $v'$, say, in
$\mathcal{B}$ as well. Thus, $q\cdot_{\mathcal{B}}v'=q'\cdot_{\mathcal{B}} v'$.
Consider the set $S\cdot_{\mathcal{B}}v'$ of the end points of all paths in
$\mathcal{B}$ that originate in $S$ and are labelled $v'$. Observe that
$|S\cdot_{\mathcal{B}}v'|<|S|$ and, since
$S\cdot_{\mathcal{B}}v'=S\cdot_{\mathcal{A}}v$, the set is still contained in a
single class of the relation $\sim$. Therefore the induction assumption
applies.
\end{proof}

Proposition~\ref{KV:prop:ckk} ``localizes'' the initial task: while
synchronization is a ``global'' property in which all vertices are involved,
the proposition shows that we may look at some pair of vertices. We need a
further localization that allows us to concentrate on the action of a single
letter. For this, we need some auxiliary notions and results.

Let $\mathcal{A}=(Q,A)$ be a DFA. A pair $(p,q)$ of distinct vertices is
\emph{compressible} if $p\cdot w=q\cdot w$ for some $w\in A^*$; otherwise it
is\index{compressible pair} \emph{incompressible}.\index{incompressible pair} A
subset $P\subseteq Q$ is said to be \emph{compressible}\index{compressible set}
if $P$ contains a compressible pair and to be \emph{incompressible} if every
pair of distinct vertices in $P$ is incompressible.\index{incompressible set}
Clearly, if $P$ is incompressible, then for every word $u\in A^*$, the set
$P\cdot u=\{p\cdot u\mid p\in P\}$ also is incompressible and $|P|=|P\cdot u|$.

\begin{lemma}
\label{KV:lemma:maximal incompressible} Let $\mathcal{A}=(Q,A)$ be a DFA and
let $P\subseteq Q$ be an incompressible set of maximum size in $\mathcal{A}$.
Suppose that there exists a word $w\in A^*$ that fixes all but one states in
$P$. Then $\mathcal{A}$ has a stable pair.
\end{lemma}

\begin{proof}
Let $q\in P$ be such that $q'=q\cdot w\ne q$ but $p\cdot w=p$ for all $p\in
P'=P\setminus\{q\}$. Take an arbitrary word $u\in A^*$; we aim to show that
$q\cdot uv=q'\cdot uv$ for a suitable word $v\in A^*$. Clearly, we may assume
that $q\cdot u\ne q'\cdot u$. Since the set $P\cdot wu$ is incompressible, the
state $q'\cdot u=q\cdot wu$ forms an incompressible pair with every state in
$P'\cdot u=P'\cdot wu$. Similarly, since the set $P\cdot u$ is incompressible,
the state $q\cdot u$ also forms an incompressible pair with every state in
$P'\cdot u$, and of course every pair of distinct states in $P'\cdot u$ is
incompressible too. Now $P'\cdot u\cup\{q\cdot u,q'\cdot u\}$ has more than
$|P|$ elements so it must be compressible, and the above analysis shows that
the only pair in $P'\cdot u\cup\{q\cdot u,q'\cdot u\}$ which may be
compressible is the pair $(q\cdot u,q'\cdot u)$. Thus, there is a word $v\in
A^*$ such that $q\cdot uv=q'\cdot uv$, and the pair $(q,q')$ is stable.
\end{proof}

Suppose that $\mathcal{A}=(Q,A)$ is a DFA. Fix a letter $a\in A$ and remove all
edges of $\mathcal{A}$ except those labelled $a$. The remaining graph is called
the \emph{underlying graph of $a$}\index{graph!of a letter} or simply the
$a$-\emph{graph}. Thus, in the $a$-graph every vertex is the tail of exactly
one edge. From every state $q\in Q$, one can start a path in the $a$-graph:
$$q\xrightarrow{a} q\cdot
a\xrightarrow{a}q\cdot a^2\dots\xrightarrow{a} q\cdot a^k\dotsc.$$ Since the
set $Q$ is finite, states in this path eventually begin repeating, that is, for
some non-negative integer $\ell$ and some integer $m>\ell$ we have $q\cdot
a^\ell=q\cdot a^m$.
\begin{figure}[ht]
\begin{center}
\unitlength=1.7mm
\begin{picture}(90,15)(13,0)
\multiput(15,9)(10,0){3}{\circle*{1}} \multiput(16,9)(10,0){2}{\vector(1,0){8}}
\multiput(20,10)(10,0){2}{$a$} \multiput(38,9)(2,0){3}{\circle*{0.2}}
\multiput(45,9)(10,0){2}{\circle*{1}} \put(46,9){\vector(1,0){8}}
\put(50,10){$a$} \put(67,11.5){$a$} \put(56,9.5){\vector(2,1){6.4}}
\multiput(63,13)(10,0){2}{\circle*{1}} \put(64,13){\vector(1,0){8}}
\put(59,9.5){$a$} \put(74,12.5){\vector(2,-1){6.4}} \put(76,9.5){$a$}
\put(82,9){\circle*{1}} \put(81,8.5){\vector(-2,-1){6.4}} \put(77,7.5){$a$}
\multiput(63.3,5)(10,0){2}{\circle*{1}} \multiput(66,5)(2,0){3}{\circle*{0.2}}
\put(62.5,5.5){\vector(-2,1){6.4}} \put(60,7.5){$a$} \small \put(14.3,6){$q$}
\put(23.6,6){$q\cdot a$} \put(33.6,6){$q\cdot a^2$} \put(43.4,6){$q\cdot
a^{\ell-1}$} \put(53.5,6){$q\cdot a^{\ell}$} \put(61.3,2){$q\cdot a^{m-1}$}
\put(61.3,14.5){$q\cdot a^{\ell+1}$} \put(71.4,14.5){$q\cdot a^{\ell+2}$}
\put(80.4,6){$q\cdot a^{\ell+3}$} \put(71.4,2){$q\cdot a^{\ell+4}$}
\end{picture}
\caption{The orbit of a state in the underlying graph of a
letter}\label{KV:fig:a-orbit}
\end{center}
\end{figure}
In other words, each path in the $a$-graph eventually arrives at a cycle, see
Fig.\,\ref{KV:fig:a-orbit}. The least non-negative integer $\ell$ such that
$q\cdot a^\ell=q\cdot a^m$ for some $m>\ell$ is called the $a$-\emph{level} of
the state $q$ and the state $q\cdot a^{\ell}$ is called the \emph{root} of $q$.
The cycles of the $a$-graph are referred to as $a$-\emph{cycles}.

\begin{lemma}
\label{KV:lemma:common root} Let $\mathcal{A}=(Q,A)$ be a \scn\ DFA. Suppose
that there is a letter $a\in A$ such that all states of maximal $a$-level $L>0$
have the same root. Then $\mathcal{A}$ has a stable pair.
\end{lemma}


\begin{proof}
Let $M$ be the set of all states of $a$-level $L$. Then $q\cdot a^L=q'\cdot
a^L$ for all $q,q'\in M$ whence no pair of vertices from $M$ is incompressible.
Thus, any incompressible set in $\mathcal{A}$ has at most one common state with
$M$. Take  an incompressible set $S$ of maximum size in $\mathcal{A}$ and
choose any state $p\in S$. Since the automaton is $\mathcal{A}$ \scn, there is
a path from $p$ to a state in $M$. If $u\in A^*$ is the word that labels this
path, then $S'=S\cdot u$ is an incompressible set of maximum size and it has
exactly one common state with $M$ (namely, $p\cdot u$). Then $S''=S'.a^{L-1}$
is an incompressible set of maximum size that has all its states except one
(namely, $p\cdot ua^{L-1}$) in some $a$-cycles---the latter conclusion is
ensured by our choice of $L$. If $m$ is the l.c.m. of the lengths of all simple
$a$-cycles, then $a^m$ fixes all states in every $a$-cycle but $(p\cdot
ua^{L-1})\cdot a=p\cdot ua^{L}\ne p\cdot ua^{L-1}$. We see that
Lemma~\ref{KV:lemma:maximal incompressible} applies (with $S''$ in the role $P$
and $a^m$ in the role of $w$).
\end{proof}

Now we are ready to prove
\begin{theorem}[{\mdseries\cite{Trahtman:2009}}]
\label{KV:thm:road coloring} Every \scn\ primitive graph $\Gamma$ with constant
out-degree admits a synchronizing coloring.
\end{theorem}

\begin{proof}
If $\Gamma$ has just one vertex, it is nothing to prove. Thus, we assume that
$\Gamma$ has more than one vertex and prove that it admits a coloring with a
stable pair of states---the result will then follow from
Proposition~\ref{KV:prop:ckk}.

Fix an arbitrary coloring of $\Gamma$ by letters from an alphabet $A$ and take
an arbitrary letter $a\in A$. We induct on the number $N$ of states that do not
lie on any $a$-cycle in the chosen coloring.

We say that a vertex $p$ of $\Gamma$ is \emph{ramified}\index{vertex!ramified}
if it serves as the tail for some edges with different heads.

Suppose that $N=0$. This means that all states lie on the $a$-cycles. If we
suppose that no vertex in $\Gamma$ is ramified, then there is just one
$a$-cycle (since $\Gamma$ is \scn) and all cycles in $\Gamma$ have the same
length. This contradicts the assumption that $\Gamma$ is
primitive\footnote{This is the only place in the whole proof where primitivity
is used!}.

Thus, let $p$ be a vertex which is ramified. Then there exists a letter $b\in
A$ such that the states $q = p\cdot a$ and  $r = p\cdot b$ are not equal. We
exchange the labels of the edges $p\stackrel{a}{\to}q$ and
$p\stackrel{b}{\to}r$, see Fig.\,\ref{KV:fig:rcp-basis}.
\begin{figure}[h]
\begin{center}
\unitlength .7mm
\begin{picture}(200,40)(13.5,-15)
\node(A)(20,-5){} \node(B)(30,15){} \node(C)(55,22){$p$} \node(D)(80,15){$q$}
\node(E)(90,-5){} \node(X)(65,5){$r$} \drawedge(A,B){$a$} \drawedge(B,C){$a$}
\drawedge(D,E){$a$} \drawedge[dash={1.5}0,ELside=r,curvedepth=5](E,A){$a^k$}
\drawedge(C,D){$a$} \drawedge[linewidth=.6](C,X){$b$} \node(A1)(120,-5){}
\node(B1)(130,15){} \node(C1)(155,22){$p$} \node(D1)(180,15){$q$}
\node(E1)(190,-5){} \node(X1)(165,5){$r$} \drawedge[linewidth=.6](C1,D1){$b$}
\drawedge(C1,X1){$a$} \drawedge(A1,B1){$a$} \drawedge(B1,C1){$a$}
\drawedge(D1,E1){$a$}
\drawedge[dash={1.5}0,ELside=r,curvedepth=5](E1,A1){$a^k$}
\end{picture}
\end{center}
\caption{Recoloring in the induction basis}\label{KV:fig:rcp-basis}
\end{figure}
It is clear that in the new coloring there is only one state of maximal
$a$-level, namely, the state $q$. Thus, Lemma~\ref{KV:lemma:common root}
applies and the induction basis is verified.

Now suppose that $N>0$. We denote by $L$ the maximum $a$-level of the states in
the chosen coloring. Observe that $N>0$ implies $L>0$.

Let $p$ be a state of level $L$. Since $\Gamma$ is strongly connected, there is
an edge $p'\to p$ with $p'\ne p$, and by the choice of $p$, the label of this
edge is some letter $b\ne a$. Let $t=p'\cdot a$. One has $t\ne p$. Let $r =
p\cdot a^L$ be the root of $p$ and let $C$ be the $a$-cycle on which $r$ lies.

The following considerations split in several cases. In each case except one we
can recolor $\Gamma$ by swapping the labels of two edges so that the new
coloring either satisfies the premise of Lemma~\ref{KV:lemma:common root} (all
states of maximal $a$-level have the same root) or has more states on the
$a$-cycles (and the induction assumption applies). In the remaining case
finding a stable pair will be easy.

\medskip

 \textbf{Case 1: $p'$ is not on $C$.}

\begin{figure}[h]
\begin{center}
\unitlength .9mm
\begin{picture}(130,24)
\node(A)(0,10){$p'$} \node(B)(15,20){$p$} \node(C)(15,0){$t$}
\node(D)(40,20){$r$} \drawedge[dash={1.5}0](B,D){$a^L$}
\drawloop[dash={1.5}0,loopangle=0](D){$a^k$} \drawedge[linewidth=.6](A,B){$b$}
\drawedge(A,C){$a$} \node(A1)(80,10){$p'$} \node(B1)(95,20){$p$}
\node(C1)(95,0){$t$} \node(D1)(120,20){$r$}
\drawedge[dash={1.5}0](B1,D1){$a^L$}
\drawloop[dash={1.5}0,loopangle=0](D1){$a^k$} \drawedge(A1,B1){$a$}
\drawedge[linewidth=.6](A1,C1){$b$}
\end{picture}
\end{center}
\caption{Recoloring in Case 1}\label{fig:rcp-case1}
\end{figure}

We swap the labels of $p'\stackrel{b}{\to}p$ and $p'\stackrel{a}{\to}t$, see
Fig.\,\ref{fig:rcp-case1}. If $p'$ was on the $a$-path from $p$ to $r$, then
the swapping creates a new $a$-cycle increasing the number of states on the
$a$-cycles. If $p'$ was not on the $a$-path from $p$ to $r$, then the $a$-level
of $p'$ becomes $L+1$ whence all states of maximal $a$-level in the new
automaton are $a$-ascendants of $p'$ and thus have $r$ as the common root.

\medskip

\textbf{Case 2: $p'$ is on $C$.} Let $k_1$ be the least integer such that
$r\cdot a^{k_1}=p'$. The state $t=p'\cdot a$ is also on $C$. Let $k_2$ be the
least integer such that $t\cdot a^{k_2}=r$. Then the length of $C$ is
$k_1+k_2+1$.

\begin{figure}[h]
\begin{center}
\unitlength .9mm
\begin{picture}(130,24)
\node(A)(0,15){$p'$} \node(B)(15,15){$p$} \node(C)(15,0){$t$}
\node(D)(40,15){$r$} \drawedge[dash={1.5}0](B,D){$a^L$}
\drawedge[dash={1.5}0,curvedepth=-8,ELside=r](D,A){$a^{k_1}$}
\drawedge[dash={1.5}0,curvedepth=-3,ELside=r](C,D){$a^{k_2}$}
\drawedge[linewidth=.6](A,B){$b$} \drawedge(A,C){$a$} \node(A1)(80,15){$p'$}
\node(B1)(95,15){$p$} \node(C1)(95,0){$t$} \node(D1)(120,15){$r$}
\drawedge[dash={1.5}0](B1,D1){$a^L$}
\drawedge[dash={1.5}0,curvedepth=-8,ELside=r](D1,A1){$a^{k_1}$}
\drawedge[dash={1.5}0,curvedepth=-3,ELside=r](C1,D1){$a^{k_2}$}
\drawedge(A1,B1){$a$} \drawedge[linewidth=.6](A1,C1){$b$}
\end{picture}
\end{center}
\caption{Recoloring in Subcase 2.1}\label{KV:fig:rcp-subcase21}
\end{figure}

\textbf{Subcase 2.1: $k_2\ne L$.} Again, we swap the labels of
$p'\stackrel{b}{\to}p$ and $p'\stackrel{a}{\to}t$, see
Fig.\,\ref{KV:fig:rcp-subcase21}. If $k_2<L$, then the swapping creates an
$a$-cycle of length $k_1+L+1>k_1+k_2+1$ increasing the number of states on the
$a$-cycles. If $k_2>L$, then the $a$-level of $t$ becomes $k_2$ whence all
states of maximal $a$-level in the new automaton are $a$-ascendants of $t$ and
thus have the same root.

\medskip

Let $s$ be the state of $C$ such that $s\cdot a=r$.

\textbf{Subcase 2.2: $k_2=L$ and $s$ is ramified.} Since $s$ is ramified, there
is a letter $c$ such that $s'=s\cdot c\ne r$.

\begin{figure}[h]
\begin{center}
\unitlength .9mm
\begin{picture}(135,26)(0,-2)
\node(A)(0,15){$p'$} \node(B)(15,15){$p$} \node(C)(0,0){$t$}
\node(D)(40,15){$r$} \node(E)(30,0){$s$} \node(F)(45,0){$s'$}
\drawedge[dash={1.5}0](B,D){$a^L$}
\drawedge[dash={1.5}0,curvedepth=-8,ELside=r](D,A){$a^{k_1}$}
\drawedge[dash={1.5}0,ELside=r](C,E){$a^{k_2-1}$} \drawedge(E,D){$a$}
\drawedge[linewidth=.6](E,F){$c$} \drawedge(A,B){$b$} \drawedge(A,C){$a$}
\node(A1)(85,15){$p'$} \node(B1)(100,15){$p$} \node(C1)(85,0){$t$}
\node(D1)(125,15){$r$} \node(E1)(115,0){$s$} \node(F1)(130,0){$s'$}
\drawedge[dash={1.5}0](B1,D1){$a^L$}
\drawedge[dash={1.5}0,curvedepth=-8,ELside=r](D1,A1){$a^{k_1}$}
\drawedge[dash={1.5}0,ELside=r](C1,E1){$a^{k_2-1}$}
\drawedge[linewidth=.6](E1,D1){$c$} \drawedge(E1,F1){$a$} \drawedge(A1,B1){$b$}
\drawedge(A1,C1){$a$}
\end{picture}
\end{center}
\caption{Recoloring in Subcase 2.2}\label{KV:fig:rcp-subcase22}
\end{figure}

We swap the labels of $s\stackrel{c}{\to}s'$ and $s\stackrel{a}{\to}r$, see
Fig.\,\ref{KV:fig:rcp-subcase21}. If $r$ still lies on an $a$-cycle, then the
length of the $a$-cycle is at least $k_1+k_2+2$ and the number of states on the
$a$-cycles increases. Otherwise, the $a$-level of $r$  becomes at least
$k_1+k_2+1>L$ whence all states of maximal $a$-level in the new automaton are
$a$-ascendants of $r$ and have a common root.

\medskip

Let $q$ be the state on the $a$-path from $p$ to $r$ such that $q\cdot a=r$.

\textbf{Subcase 2.3: $k_2=L$ and $q$ is ramified.} Since $q$ is ramified, there
is a letter $c$ such that $q'=q\cdot c\ne r$.

\begin{figure}[h]
\begin{center}
\unitlength .9mm
\begin{picture}(135,28)(0,-2)
\node(A)(0,15){$p'$} \node(B)(15,15){$p$} \node(C)(0,0){$t$}
\node(D)(50,15){$r$} \node(E)(35,15){$q$} \node(F)(25,5){$q'$}
\drawedge[dash={1.5}0](B,E){$a^{L-1}$}
\drawedge[dash={1.5}0,curvedepth=-8,ELside=r](D,A){$a^{k_1}$}
\drawedge[dash={1.5}0,ELside=r,ELpos=70,curvedepth=-10](C,D){$a^{k_2}$}
\drawedge(E,D){$a$} \drawedge(E,F){$c$} \drawedge[linewidth=.6](A,B){$b$}
\drawedge(A,C){$a$} \node(A1)(85,15){$p'$} \node(B1)(100,15){$p$}
\node(C1)(85,0){$t$} \node(D1)(135,15){$r$} \node(E1)(120,15){$q$}
\node(F1)(110,5){$q'$} \drawedge[dash={1.5}0](B1,E1){$a^{L-1}$}
\drawedge[dash={1.5}0,curvedepth=-8,ELside=r](D1,A1){$a^{k_1}$}
\drawedge[dash={1.5}0,ELside=r,ELpos=70,curvedepth=-10](C1,D1){$a^{k_2}$}
\drawedge(E1,D1){$a$} \drawedge(E1,F1){$c$} \drawedge(A1,B1){$a$}
\drawedge[linewidth=.6](A1,C1){$b$}
\end{picture}
\end{center}
\caption{Recoloring reducing Subcase 2.3 to Subcase
2.2}\label{KV:fig:rcp-subcase23}
\end{figure}

If we swap the labels of $p'\stackrel{b}{\to}p$ and $p'\stackrel{a}{\to}t$,
then we find ourselves in the conditions of Subcase~2.2 (with $q$ and $q'$
playing the roles of $s$ and $s'$ respectively), see
Fig.\,\ref{KV:fig:rcp-subcase23}.

\medskip

\textbf{Subcase 2.4: $k_2=L$ and neither $s$ nor $q$ is ramified.}

\begin{figure}[h]
\begin{center}
\unitlength .9mm
\begin{picture}(50,30)(0,-7.5)
\node(A)(0,15){$p'$} \node(B)(15,15){$p$} \node(C)(0,-5){$t$}
\node(D)(50,5){$r$} \node(E)(35,15){$q$} \node(F)(35,-5){$s$}
\drawedge[dash={1.5}0](B,E){$a^{L-1}$}
\drawedge[dash={1.5}0,curvedepth=5,ELside=r](D,A){$a^{k_1}$}
\drawedge[dash={1.5}0](C,F){$a^{k_2-1}$} \drawedge(E,D){}
\drawedge[curvedepth=3](E,D){$a$} \drawedge[curvedepth=-3](E,D){}
\drawedge(A,B){$b$} \drawedge(A,C){$a$} \drawedge(F,D){}
\drawedge[curvedepth=3](F,D){} \drawedge[curvedepth=-3,ELside=r](F,D){$a$}
\end{picture}
\end{center}
\caption{Subcase 2.4}\label{KV:fig:rcp-subcase24}
\end{figure}

In this subcase it is clear that $q$ and $s$ form a stable pair whichever
coloring of $\Gamma$ is chosen, see~Fig.\,\ref{KV:fig:rcp-subcase24}. This
completes the proof.
\end{proof}

The above proof of Theorem~\ref{KV:thm:road coloring} is constructive and can
be ``unfolded'' to an algorithm that, given a \scn\ primitive graph $\Gamma$
with constant out-degree, finds a synchronizing coloring of $\Gamma$; moreover,
this can be done in time quadratic in the number of vertices in $\Gamma$,
see~\cite{Beal&Perrin:2008}.

If one drops the primitivity condition, one can prove (basically by the same
method) the following generalization of the Road Coloring Theorem,
see~\cite{Beal&Perrin:2008}:

\begin{theorem}
\label{KV:thm:rcp-imprimitive} Suppose that $d$ is the g.c.d. of the lengths of
cycles in a \scn\ graph $\Gamma=(V,E)$ with constant out-degree.  Then $\Gamma$
admits a coloring for which there is a word $w$ such that $|V\cdot w|=d$.
\end{theorem}

Finally, we discuss a general version of the Road Coloring Problem in which
graphs are not assumed to be \scn. Given an arbitrary graph $\Gamma$, a vertex
$q$ is said to be \emph{reachable} from a vertex $p$ if there is a path from
$p$ to $q$. Clearly,  the \emph{reachability relation}\index{reachability
relation} is transitive, and the mutual reachability relation is an equivalence
on the vertex set of $\Gamma$. The subgraphs induced on the classes of the
mutual reachability relation are \scn\ and are called the \emph{\scn\
components} of the graph $\Gamma$.\index{strongly connected component} The
reachability relation induces a partial order on the set of the \scn\
components: a component $\Gamma_1$ precedes a component $\Gamma_2$ in this
order if some vertex of $\Gamma_1$ is reachable from some vertex of $\Gamma_2$.
The following result shows that the general case of the Road Coloring Problem
easily reduces to its \scn\ case (solved by Theorem~\ref{KV:thm:road
coloring}):

\begin{corollary}
\label{KV:cor:rcp-general} A graph $\Gamma$ with constant out-degree admits a
synchronizing coloring if and only if $\Gamma$ has the least \scn\ component
and this component is primitive.
\end{corollary}

An interesting issue related to the Road Coloring Problem is the choice of the
\emph{optimal} synchronizing coloring for a given graph. Clearly, graphs
admitting a synchronizing coloring may have many colorings and reset thresholds
of the resulting \sa\ may drastically differ. For instance, it is easy  to see
that the \v{C}ern\'y automaton $\mathcal{C}_n$ whose \rt\ $(n-1)^2$ is believed
to be maximum possible for an $n$-state automaton admits a recoloring with \rt\
is as low as $n-1$ (and moreover, every \scn\ graph $\Gamma$ with constant
out-degree that has a loop admits a synchronizing coloring whose \rt\ is less
than the number of vertices of $\Gamma$). Nevertheless, there exist graphs
whose synchronizing coloring are ``slowly'' \sa. As an example, consider the
\emph{Wielandt graph}\index{graph!Wielandt} $W_n$ shown in
Figure~\ref{KV:fig:Wielandt}.
\begin{figure}[ht]
\begin{center}
\unitlength .45mm
\begin{picture}(72,72)(0,-72)
\gasset{Nw=16,Nh=16,Nmr=8} \node(n0)(36.0,-16.0){1} \node(n1)(4.0,-40.0){$0$}
\node(n2)(68.0,-40.0){2} \node(n3)(16.0,-72.0){$n{-}1$}
\node(n4)(56.0,-72.0){3} \drawedge(n1,n0){} \drawedge[curvedepth=2](n2,n4){}
\drawedge[curvedepth=-2](n2,n4){} \drawedge[curvedepth=2](n0,n2){}
\drawedge[curvedepth=-2](n0,n2){} \drawedge[curvedepth=2](n3,n1){}
\drawedge[curvedepth=-2](n3,n1){} \drawedge(n1,n2){} \put(32,-73){$\dots$}
\end{picture}
\end{center}
\caption{The graph $W_n$}\label{KV:fig:Wielandt}
\end{figure}
It has $n$ vertices $0,1,\dots,n-1$, say, and $2n$ edges: two edges from $i$ to
$i+1\pmod n$ for each $i=1,\dots,n-1$, and the edges from $0$ to $1$ and $2$.
The graph (more precisely, its incidence matrix) first appeared in Wielandt's
seminal paper~\cite{Wielandt:1950} where Wielandt stated that for every
primitive non-negative $n\times n$-matrix $M$, the matrix $M^{(n-1)^2+1}$ is
positive. The incidence matrix of $W_n$ was used to show that this bound is
tight (that is, its $(n-1)^2$-th power still has some 0 entries); later it was
observed to be the only (up to a simultaneous permutation of rows and columns)
matrix with this property, see~\cite{Dulmage&Mendelson:1964}.

It is easy to realize that every coloring of the graph $W_n$ is isomorphic to
the automaton $\mathcal{W}_n$ shown in Figure~\ref{KV:fig:cerny-n} on the
right. Since $W_n$ is \scn\ and primitive, the Road Coloring Theorem implies
that $\mathcal{W}_n$ is synchronizing (of course, this can also be verified
directly). In \cite{Ananichev&Gusev&Volkov:2010} it is shown that the \rt\ of
$\mathcal{W}_n$ is $n^2-3n+3$, see the proof of Proposition~\ref{KV:prop:cerny}
above. The aforementioned extremal property of the Wielandt graphs gives some
evidence for conjecturing that this series of graphs may yield the extremal
value also for the \rt\ of synchronizing colorings of $n$-vertex graph. In
other words, we suggest a conjecture that is in a sense parallel to the
\v{C}ern\'{y} one.
\begin{conjecture}
\label{KV:conj:hybrid} Every \scn\ primitive graph with constant outdegree and
$n$ vertices admits a synchronizing coloring that can be reset by a word of
length $n^2-3n+3$.
\end{conjecture}
We observe that while there is a clear analogy between
Conjecture~\ref{KV:conj:hybrid} and the \v{C}ern\'{y} conjecture, the validity
of none of them immediately implies the validity of the other.

Some first partial results related to Conjecture~\ref{KV:conj:hybrid} can be
found in~\cite{Steinberg:2010archive,Carpi&D'Alessandro:2010}.
Roman~\cite{Roman:2011} has shown that the problem of finding the optimal
synchronizing coloring for a given graph is computationally hard. Namely, the
following decision problem
\index{Bounded@\textsc{Bounded-Synchronizing-\protect\\ Coloring}} is
\textsf{NP}-complete:

\smallskip

\hangindent=\parindent \noindent \textsc{Bounded-Synchronizing-Coloring:}
\emph{Given a \scn\ primitive graph $\Gamma$ with constant outdegree, is it
true that $\Gamma$ has a synchronizing coloring with a reset word of length
$8$?}

%=====================================================
\section{Related work}
\label{KV:sec:related}
%=====================================================

\bibliographystyle{abbrv}
\addcontentsline{toc}{section}{References}
\begin{footnotesize}
  \bibliography{abbrevs,SA}
\end{footnotesize}


\addcontentsline{toc}{section}{Index}
\markright{\indexname}\markboth{\indexname}{\indexname}
\printindex

\end{document}
